# 情報収集プロンプト（Claude + 外部LLM共通）

## 概要

このディレクトリには、**Claude および外部LLM**が情報収集を行うための共通プロンプトが含まれています。

**重要**: Claude と外部LLMは**同じプロンプト・同じフォーマット**で出力し、統合時に同等に扱われます。

---

## ファイル一覧

| ファイル | 用途 | 実行者 |
|----------|------|--------|
| `00_common_instructions.md` | 共通指示書（必読） | 全LLM |
| `01_company_discovery.md` | 企業発掘（50社） | Claude / 外部LLM |
| `02_broad_intelligence.md` | 7カテゴリ広域情報収集 | Claude / 外部LLM |
| `03_monopoly_info.md` | 独占マップ情報収集 | Claude / 外部LLM |
| `04_financial_management.md` | 財務・経営評価情報 | Claude / 外部LLM |
| `05_consolidation_guide.md` | 統合処理ガイド | Claude専用 |

---

## Claudeでの実行

### コマンド一覧

| コマンド | 実行内容 | 出力先 |
|----------|---------|--------|
| `企業発掘を収集` | 01_company_discovery.md を実行 | `raw/company_discovery/claude_*.md` |
| `広域情報を収集` | 02_broad_intelligence.md を実行 | `raw/broad_intelligence/claude_*.md` |
| `独占情報を収集` | 03_monopoly_info.md を実行 | `raw/monopoly_info/claude_*.md` |
| `財務情報を収集` | 04_financial_management.md を実行 | `raw/financial_management/claude_*.md` |
| `全情報を収集` | 上記4タイプを全て実行 | 各raw/フォルダ |
| `情報を統合` | 全raw/出力を統合 | `consolidated_*.json` |

### 実行フロー

```
「全情報を収集」
    ↓
Claude: 4タイプの情報収集を実行
    ↓
data/intelligence/raw/ に保存
    ↓
「情報を統合」
    ↓
consolidated_*.json を生成
```

---

## ★重要: タスク間の依存関係★

```
┌─────────────────────────────────────────────────────────────┐
│              タスク実行順序と依存関係                        │
├─────────────────────────────────────────────────────────────┤
│                                                             │
│  [タスク1] 企業発掘 ←── 最初に実行（依存なし）             │
│       ↓                                                     │
│       ↓ 50社リストを出力                                    │
│       ↓                                                     │
│  [タスク2] 広域情報 ←── 独立実行可能                       │
│       │                                                     │
│  [タスク3] 独占情報 ←── 独立実行可能（企業リスト推奨）     │
│       │                   └─ 重点企業を指定すると効率的     │
│       ↓                                                     │
│  [タスク4] 財務情報 ←── ★企業リスト必須★                 │
│                           └─ タスク1の50社を入力する       │
│                                                             │
└─────────────────────────────────────────────────────────────┘
```

### データの受け渡し方法（ファイル参照方式）

| タスク | 入力データ | 入力方法 |
|--------|-----------|----------|
| タスク1（企業発掘） | なし | そのまま実行 |
| タスク2（広域情報） | なし | そのまま実行 |
| タスク3（独占情報） | タスク1出力（推奨） | タスク1の出力ファイルを参照 |
| タスク4（財務情報） | **タスク1出力（必須）** | タスク1の出力ファイルを参照 |

**ファイル参照の仕組み**:
- Claude: `data/intelligence/raw/company_discovery/` から直接読み込み
- 外部LLM: タスク1の出力ファイルをアップロードして参照

---

## 外部LLMでの実行

### 実行手順

1. `00_common_instructions.md` の内容をコピー
2. タスク別プロンプト（01〜04）の内容をコピー
3. **タスク3/4の場合**: タスク1の出力ファイルをアップロード
4. 外部LLMに貼り付けて実行
5. 出力をMarkdownファイルとして保存
6. `data/intelligence/raw/[タイプ]/[llm名]_YYYYMMDD.md` に配置

### タスク3/4でのファイル参照

```
外部LLM（GPT-4、Gemini等）でタスク3/4を実行する場合:

1. まずタスク1を実行し、出力をファイル保存
2. タスク3/4実行時に、そのファイルをアップロード
3. LLMがファイル内の50社を自動的に参照
```

### 保存先

```
data/intelligence/raw/
├── company_discovery/
│   ├── claude_20250126.md      ← Claude出力
│   ├── gemini_20250126.md      ← 外部LLM出力
│   └── gpt4_20250126.md
├── broad_intelligence/
│   └── ...
├── monopoly_info/
│   └── ...
└── financial_management/
    └── ...
```

---

## 推奨LLM組み合わせ

### 企業発掘（01）

| LLM | 強み | 推奨度 |
|-----|------|--------|
| **Claude** | 分析力、日本語理解 | ◎ |
| Gemini | 日本語情報に強い | ◎ |
| GPT-4 | 広範な知識 | ◎ |
| Perplexity | リアルタイム検索 | ○ |

### 広域情報（02）

| LLM | 強み | 推奨度 |
|-----|------|--------|
| **Claude** | 分析・整理 | ◎ |
| Perplexity | 最新ニュース検索 | ◎ |
| Gemini | 日本語ニュース | ◎ |
| GPT-4 | 分析・整理 | ○ |

### 独占マップ情報（03）

| LLM | 強み | 推奨度 |
|-----|------|--------|
| **Claude** | 構造化、分析 | ◎ |
| Gemini | 日本企業情報 | ◎ |
| GPT-4 | グローバル市場データ | ◎ |

### 財務情報（04）

| LLM | 強み | 推奨度 |
|-----|------|--------|
| **Claude** | 財務分析、計算 | ◎ |
| Gemini | EDINET情報 | ◎ |
| GPT-4 | 財務分析 | ○ |

---

## 出力品質の確認ポイント

### 必須チェック項目

- [ ] メタデータが記載されているか
- [ ] 全情報に4次元評価が付与されているか
- [ ] ソースが明記されているか
- [ ] フォーマットが正しいか

### 品質が低い場合

1. 4次元評価がない → 再実行を依頼
2. ソースがない → 検証度を下げて処理
3. フォーマットエラー → 手動修正

---

## 4タイプと4軸評価の対応

```
┌─────────────────────────────────────────────────────────┐
│                  4軸評価（100点満点）                    │
├─────────────────────────────────────────────────────────┤
│  独占力（30点）←── 企業発掘 + 独占マップ情報            │
│  資本効率（20点）←── 財務・経営評価                     │
│  シナジー（25点）←── 企業発掘 + 広域情報                │
│  非対称性（25点）←── 全タイプ                          │
└─────────────────────────────────────────────────────────┘

タスク1: 企業発掘 ──────→ 独占力、シナジー
タスク2: 広域情報 ──────→ シナジー、非対称性
タスク3: 独占マップ ────→ 独占力（30点）
タスク4: 財務・経営 ────→ 資本効率（20点）
```

---

## 統合の仕組み

```
Claude出力 + 外部LLM出力
         ↓
    重複排除
    （同一企業/情報を検出）
         ↓
    矛盾解決
    （シェア情報等の不一致を解決）
         ↓
    検証度昇格
    （複数ソース → multi_source）
         ↓
  consolidated_*.json
```

### 検証度昇格の例

```
Claude: 「A社のシェアは90%」
Gemini: 「A社のシェアは90%」
    ↓
統合後: verification.level = "multi_source"
（2つの独立したソースで確認されたため昇格）
```

---

## トラブルシューティング

| 問題 | 対応 |
|------|------|
| LLMが4次元評価を付与しない | 共通指示書を再度貼り付け、「4次元評価を必ず付与」と強調 |
| 出力が長すぎる | 情報件数を減らして再実行 |
| 日本語が文字化け | UTF-8で保存を確認 |
| 統合時にエラー | `05_consolidation_guide.md` の警告対応を確認 |
| Claudeの出力が保存されない | ファイルパスとフォーマットを確認 |
