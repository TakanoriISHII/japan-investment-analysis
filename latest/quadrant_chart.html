<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japan Top 30 - 4Ë±°Èôê„Éû„Éà„É™„ÉÉ„ÇØ„Çπ</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
        }
        #root { width: 100%; min-height: 100vh; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const japanTop30Data = [
            { rank: 1, ticker: "7011.T", name: "‰∏âËè±ÈáçÂ∑•Ê•≠", certainty: 95, upside: 45, total: 88, monopoly: 28, resilience: 19, synergy: 22, asymmetry: 12, capital: 7, domain: "Èò≤Ë°õ", core_tech: "Èò≤Ë°õË£ÖÂÇôÂìÅ„ÄÅÂéüÂ≠êÂäõ„ÄÅËà™Á©∫ÂÆáÂÆô", thesis: "Èò≤Ë°õË£ÖÂÇôÂìÅÂ•ëÁ¥ÑÈ¶ñ‰ΩçÔºà1ÂÖÜ4,567ÂÑÑÂÜÜÔºâ„ÄÇÂèóÊ≥®1.87ÂÖÜÂÜÜ„ÄÇÊó•Ëã±‰ºäÊ¨°ÊúüÊà¶ÈóòÊ©üÂÖ±ÂêåÈñãÁô∫„ÄÇÈò≤Ë°õË≤ª9ÂÖÜÂÜÜË∂Ö„ÅßÊúÄÂ§ßÂèóÁõäËÄÖ„ÄÇ" },
            { rank: 2, ticker: "8035.T", name: "Êù±‰∫¨„Ç®„É¨„ÇØ„Éà„É≠„É≥", certainty: 95, upside: 40, total: 86, monopoly: 27, resilience: 17, synergy: 22, asymmetry: 12, capital: 8, domain: "ÂçäÂ∞é‰Ωì", core_tech: "ÂçäÂ∞é‰ΩìË£ΩÈÄ†Ë£ÖÁΩÆ", thesis: "„Ç≥„Éº„Çø/„Éá„Éô„É≠„ÉÉ„Éë‰∏ñÁïåÈ¶ñ‰Ωç„ÄÇAIÂçäÂ∞é‰ΩìÈúÄË¶ÅÁ∂ôÁ∂ö„ÄÇ" },
            { rank: 3, ticker: "6954.T", name: "„Éï„Ç°„Éä„ÉÉ„ÇØ", certainty: 99, upside: 45, total: 85, monopoly: 26, resilience: 17, synergy: 21, asymmetry: 14, capital: 7, domain: "„É≠„Éú„ÉÜ„Ç£„ÇØ„Çπ", core_tech: "CNC„ÄÅÁî£Ê•≠Áî®„É≠„Éú„ÉÉ„Éà", thesis: "CNC‰∏ñÁïåÈ¶ñ‰Ωç„ÄÇQ3„É≠„Éú„ÉÉ„ÉàÂèóÊ≥®+38%„ÄÇCRX-H1„Éí„É•„Éº„Éû„Éé„Ç§„Éâ2026Âπ¥H2ÈáèÁî£„ÄÇ" },
            { rank: 4, ticker: "6501.T", name: "Êó•Á´ãË£Ω‰ΩúÊâÄ", certainty: 90, upside: 42, total: 82, monopoly: 25, resilience: 17, synergy: 21, asymmetry: 11, capital: 8, domain: "„Ç®„Éç„É´„ÇÆ„Éº", core_tech: "„Ç∞„É™„ÉÉ„Éâ„ÄÅHVDC", thesis: "„Ç∞„É™„ÉÉ„ÉâÂ§âÂúßÂô®40%„Ç∑„Çß„Ç¢„ÄÇBWRX-300„ÅßSMRÂ∏ÇÂ†¥ÂèÇÂÖ•„ÄÇ" },
            { rank: 5, ticker: "9432.T", name: "NTT", certainty: 90, upside: 30, total: 80, monopoly: 25, resilience: 18, synergy: 18, asymmetry: 10, capital: 9, domain: "AI", core_tech: "„Éá„Éº„Çø„Çª„É≥„Çø„Éº„ÄÅIOWN", thesis: "ÂõΩÂÜÖDC60%„Ç∑„Çß„Ç¢„ÄÇIOWNÈáèÂ≠êÂÆâÂÖ®ÊäÄË°ì„ÄÇ" },
            { rank: 6, ticker: "6506.T", name: "ÂÆâÂ∑ùÈõªÊ©ü", certainty: 95, upside: 42, total: 79, monopoly: 24, resilience: 16, synergy: 20, asymmetry: 11, capital: 8, domain: "„É≠„Éú„ÉÜ„Ç£„ÇØ„Çπ", core_tech: "„Çµ„Éº„Éú„É¢„Éº„Çø", thesis: "„Çµ„Éº„Éú„É¢„Éº„Çø‰∏ñÁïåÈ¶ñ‰Ωç„ÄÇMOTOMAN-HM„Éí„É•„Éº„Éû„Éé„Ç§„ÉâÈñãÁô∫‰∏≠„ÄÇ" },
            { rank: 7, ticker: "6701.T", name: "NEC", certainty: 95, upside: 45, total: 78, monopoly: 23, resilience: 18, synergy: 18, asymmetry: 11, capital: 8, domain: "„Çµ„Ç§„Éê„Éº", core_tech: "„Çµ„Ç§„Éê„Éº„Çª„Ç≠„É•„É™„ÉÜ„Ç£", thesis: "ÊîøÂ∫úÂêë„Åë„Çµ„Ç§„Éê„Éº„Çª„Ç≠„É•„É™„ÉÜ„Ç£„ÄÇProtect.jpË®≠Á´ã„ÄÇ" },
            { rank: 8, ticker: "7012.T", name: "Â∑ùÂ¥éÈáçÂ∑•Ê•≠", certainty: 90, upside: 42, total: 76, monopoly: 24, resilience: 17, synergy: 18, asymmetry: 10, capital: 7, domain: "Èò≤Ë°õ", core_tech: "Èò≤Ë°õË£ÖÂÇôÂìÅ„ÄÅËà™Á©∫ÂÆáÂÆô", thesis: "Èò≤Ë°õË£ÖÂÇôÂìÅÂ•ëÁ¥Ñ2‰Ωç„ÄÇÊ¨°ÊúüÊà¶ÈóòÊ©üÂèÇÁîª„ÄÇ" },
            { rank: 9, ticker: "7013.T", name: "IHI", certainty: 90, upside: 48, total: 75, monopoly: 23, resilience: 17, synergy: 18, asymmetry: 10, capital: 7, domain: "„Ç®„Éç„É´„ÇÆ„Éº", core_tech: "Ëà™Á©∫„Ç®„É≥„Ç∏„É≥„ÄÅSMR", thesis: "NuScale SMR„Éë„Éº„Éà„Éä„Éº„ÄÇËà™Á©∫„Ç®„É≥„Ç∏„É≥ÈÉ®ÂìÅ„ÄÇ" },
            { rank: 10, ticker: "186A.T", name: "Astroscale", certainty: 85, upside: 80, total: 74, monopoly: 26, resilience: 14, synergy: 17, asymmetry: 13, capital: 4, domain: "ÂÆáÂÆô", core_tech: "„Éá„Éñ„É™Èô§Âéª", thesis: "ËªåÈÅì‰∏ä„Çµ„Éº„Éì„Çπ‰∏ñÁïå„É™„Éº„ÉÄ„Éº„ÄÇ„Éá„Éñ„É™Èô§ÂéªÂîØ‰∏Ä„ÅÆÂÆüÁ∏æ„ÄÇ" },
            { rank: 11, ticker: "6920.T", name: "„É¨„Éº„Ç∂„Éº„ÉÜ„ÉÉ„ÇØ", certainty: 90, upside: 55, total: 73, monopoly: 28, resilience: 14, synergy: 18, asymmetry: 8, capital: 5, domain: "ÂçäÂ∞é‰Ωì", core_tech: "EUV„Éû„Çπ„ÇØÊ§úÊüª", thesis: "EUV„Éû„Çπ„ÇØÊ§úÊüª„Ç∑„Çß„Ç¢100%„ÄÇ" },
            { rank: 12, ticker: "6857.T", name: "„Ç¢„Éâ„Éê„É≥„ÉÜ„Çπ„Éà", certainty: 90, upside: 45, total: 72, monopoly: 24, resilience: 16, synergy: 18, asymmetry: 7, capital: 7, domain: "ÂçäÂ∞é‰Ωì", core_tech: "ÂçäÂ∞é‰Ωì„ÉÜ„Çπ„Çø„Éº", thesis: "SoC„ÉÜ„Çπ„Çø„Éº‰∏ñÁïåÈ¶ñ‰Ωç„ÄÇHBM„ÉÜ„Çπ„ÉàÈúÄË¶ÅÊÄ•Â¢ó„ÄÇ" },
            { rank: 13, ticker: "6861.T", name: "„Ç≠„Éº„Ç®„É≥„Çπ", certainty: 92, upside: 35, total: 71, monopoly: 24, resilience: 16, synergy: 17, asymmetry: 6, capital: 8, domain: "„É≠„Éú„ÉÜ„Ç£„ÇØ„Çπ", core_tech: "FA„Çª„É≥„Çµ„Éº", thesis: "FAÁî®„Çª„É≥„Çµ„Éº‰∏ñÁïå„Éà„ÉÉ„Éó„ÄÇÂñ∂Ê•≠Âà©ÁõäÁéá50%Ë∂Ö„ÄÇ" },
            { rank: 14, ticker: "7735.T", name: "SCREEN", certainty: 88, upside: 45, total: 70, monopoly: 25, resilience: 15, synergy: 17, asymmetry: 6, capital: 7, domain: "ÂçäÂ∞é‰Ωì", core_tech: "Ê¥óÊµÑË£ÖÁΩÆ", thesis: "„Ç¶„Çß„Éº„ÉèÊ¥óÊµÑË£ÖÁΩÆ‰∏ñÁïåÈ¶ñ‰Ωç„ÄÇ" },
            { rank: 15, ticker: "6273.T", name: "SMC", certainty: 90, upside: 38, total: 69, monopoly: 26, resilience: 15, synergy: 15, asymmetry: 6, capital: 7, domain: "„É≠„Éú„ÉÜ„Ç£„ÇØ„Çπ", core_tech: "Á©∫ÂúßÊ©üÂô®", thesis: "Á©∫ÂúßÊ©üÂô®‰∏ñÁïå„Ç∑„Çß„Ç¢40%„ÄÇ" },
            { rank: 16, ticker: "6503.T", name: "‰∏âËè±ÈõªÊ©ü", certainty: 88, upside: 40, total: 68, monopoly: 22, resilience: 17, synergy: 17, asymmetry: 6, capital: 6, domain: "Èò≤Ë°õ", core_tech: "Èò≤Ë°õ„Ç®„É¨„ÇØ„Éà„É≠„Éã„ÇØ„Çπ", thesis: "„É¨„Éº„ÉÄ„Éº„ÄÅË™òÂ∞éË£ÖÁΩÆ„ÅßÂº∑„Åø„ÄÇ" },
            { rank: 17, ticker: "6702.T", name: "ÂØåÂ£´ÈÄö", certainty: 85, upside: 42, total: 67, monopoly: 21, resilience: 17, synergy: 17, asymmetry: 6, capital: 6, domain: "„Çµ„Ç§„Éê„Éº", core_tech: "ÈáèÂ≠ê„Ç≥„É≥„Éî„É•„Éº„Çø", thesis: "ÂõΩÁî£ÈáèÂ≠ê„Ç≥„É≥„Éî„É•„Éº„ÇøÈñãÁô∫„ÄÇÂØåÂ≤≥ÂæåÁ∂ôÊ©ü„ÄÇ" },
            { rank: 18, ticker: "9433.T", name: "KDDI", certainty: 90, upside: 32, total: 66, monopoly: 22, resilience: 17, synergy: 16, asymmetry: 5, capital: 6, domain: "„Çµ„Ç§„Éê„Éº", core_tech: "ÈÄö‰ø°„Ç§„É≥„Éï„É©", thesis: "Protect.jpË®≠Á´ã„ÄÇ5G„ÉªAIÈúÄË¶Å„ÄÇ" },
            { rank: 19, ticker: "6758.T", name: "„ÇΩ„Éã„Éº", certainty: 88, upside: 35, total: 65, monopoly: 24, resilience: 15, synergy: 16, asymmetry: 4, capital: 6, domain: "AI", core_tech: "„Ç§„É°„Éº„Ç∏„Çª„É≥„Çµ„Éº", thesis: "CMOS„Çª„É≥„Çµ„Éº‰∏ñÁïå„Ç∑„Çß„Ç¢50%„ÄÇ" },
            { rank: 20, ticker: "5631.T", name: "Êó•Êú¨Ë£ΩÈãºÊâÄ", certainty: 85, upside: 50, total: 64, monopoly: 26, resilience: 16, synergy: 14, asymmetry: 4, capital: 4, domain: "„Ç®„Éç„É´„ÇÆ„Éº", core_tech: "ÂéüÂ≠êÂäõÂúßÂäõÂÆπÂô®", thesis: "ÂéüÂ≠êÂäõÂúßÂäõÂÆπÂô®‰∏ñÁïå„Ç∑„Çß„Ç¢80%„ÄÇ" },
            { rank: 21, ticker: "6141.T", name: "DMGÊ£ÆÁ≤æÊ©ü", certainty: 85, upside: 42, total: 63, monopoly: 22, resilience: 15, synergy: 16, asymmetry: 5, capital: 5, domain: "Èò≤Ë°õ", core_tech: "5Ëª∏Âä†Â∑•Ê©ü", thesis: "Ëà™Á©∫ÂÆáÂÆô„ÉªÈò≤Ë°õÂêë„ÅëÈ´òÁ≤æÂ∫¶Âä†Â∑•„ÄÇ" },
            { rank: 22, ticker: "6645.T", name: "„Ç™„É†„É≠„É≥", certainty: 85, upside: 40, total: 62, monopoly: 21, resilience: 15, synergy: 16, asymmetry: 5, capital: 5, domain: "„É≠„Éú„ÉÜ„Ç£„ÇØ„Çπ", core_tech: "FAÂà∂Âæ°Ê©üÂô®", thesis: "ÂçîÂÉç„É≠„Éú„ÉÉ„Éà„ÄÅËá™ÂæãÁßªÂãï„É≠„Éú„ÉÉ„Éà„ÄÇ" },
            { rank: 23, ticker: "6723.T", name: "„É´„Éç„Çµ„Çπ", certainty: 85, upside: 45, total: 61, monopoly: 22, resilience: 14, synergy: 16, asymmetry: 4, capital: 5, domain: "AI", core_tech: "ËªäËºâÂçäÂ∞é‰Ωì", thesis: "ËªäËºâ„Éû„Ç§„Ç≥„É≥‰∏ñÁïåÈ¶ñ‰ΩçÁ¥ö„ÄÇ" },
            { rank: 24, ticker: "6807.T", name: "Êó•Êú¨Ëà™Á©∫ÈõªÂ≠ê", certainty: 85, upside: 45, total: 60, monopoly: 22, resilience: 16, synergy: 14, asymmetry: 4, capital: 4, domain: "Èò≤Ë°õ", core_tech: "„Ç≥„Éç„ÇØ„Çø", thesis: "Ëà™Á©∫„ÉªÈò≤Ë°õÂêë„ÅëÈ´ò‰ø°È†ºÊÄß„Ç≥„Éç„ÇØ„Çø„ÄÇ" },
            { rank: 25, ticker: "6361.T", name: "ËçèÂéüË£Ω‰ΩúÊâÄ", certainty: 85, upside: 42, total: 59, monopoly: 22, resilience: 15, synergy: 14, asymmetry: 4, capital: 4, domain: "„Ç®„Éç„É´„ÇÆ„Éº", core_tech: "ÂéüÂ≠êÂäõ„Éù„É≥„Éó", thesis: "ÂéüÂ≠êÂäõ„Éù„É≥„ÉóÂõΩÂÜÖÁã¨Âç†„ÄÇCMPË£ÖÁΩÆ„ÄÇ" },
            { rank: 26, ticker: "9501.T", name: "Êù±‰∫¨ÈõªÂäõ", certainty: 70, upside: 65, total: 58, monopoly: 24, resilience: 12, synergy: 12, asymmetry: 6, capital: 4, domain: "„Ç®„Éç„É´„ÇÆ„Éº", core_tech: "ÂéüÂ≠êÂäõÁô∫Èõª", thesis: "ÊüèÂ¥éÂààÁæΩ7Âü∫„ÄÇÂÜçÁ®ºÂÉç„ÅßÂèéÁõäÊîπÂñÑ„ÄÇ" },
            { rank: 27, ticker: "7224.T", name: "Êñ∞ÊòéÂíåÂ∑•Ê•≠", certainty: 82, upside: 48, total: 57, monopoly: 24, resilience: 16, synergy: 11, asymmetry: 4, capital: 2, domain: "Èò≤Ë°õ", core_tech: "È£õË°åËâá", thesis: "US-2ÊïëÈõ£È£õË°åËâá„Åß‰∏ñÁïåÂîØ‰∏Ä„ÄÇ" },
            { rank: 28, ticker: "7739.T", name: "„Ç≠„É§„Éé„É≥ÈõªÂ≠ê", certainty: 78, upside: 55, total: 56, monopoly: 20, resilience: 14, synergy: 14, asymmetry: 5, capital: 3, domain: "ÂÆáÂÆô", core_tech: "Â∞èÂûãË°õÊòü", thesis: "„Çπ„Éö„Éº„Çπ„ÉØ„É≥Âá∫Ë≥á„ÄÇÂÆáÂÆô‰∫ãÊ•≠Êã°Â§ß„ÄÇ" },
            { rank: 29, ticker: "1963.T", name: "Êó•ÊèÆHD", certainty: 82, upside: 45, total: 55, monopoly: 21, resilience: 14, synergy: 13, asymmetry: 4, capital: 3, domain: "„Ç®„Éç„É´„ÇÆ„Éº", core_tech: "LNG„Éó„É©„É≥„Éà", thesis: "LNG EPC‰∏ñÁïå„Éà„ÉÉ„Éó3„ÄÇÊ∞¥Á¥†Èñ¢ÈÄ£„ÄÇ" },
            { rank: 30, ticker: "6779.T", name: "Êó•Êú¨ÈõªÊ≥¢", certainty: 80, upside: 48, total: 54, monopoly: 22, resilience: 13, synergy: 12, asymmetry: 4, capital: 3, domain: "ÂÆáÂÆô", core_tech: "Ê∞¥Êô∂„Éá„Éê„Ç§„Çπ", thesis: "ÂÆáÂÆô„ÉªÈò≤Ë°õÂêë„ÅëËÄêÊîæÂ∞ÑÁ∑ö„Éá„Éê„Ç§„Çπ„ÄÇ" }
        ];

        const domainColors = {
            "AI": "#a855f7", "Èò≤Ë°õ": "#3b82f6", "„Ç®„Éç„É´„ÇÆ„Éº": "#22c55e",
            "„É≠„Éú„ÉÜ„Ç£„ÇØ„Çπ": "#f97316", "ÂÆáÂÆô": "#06b6d4", "„Çµ„Ç§„Éê„Éº": "#ec4899", "ÂçäÂ∞é‰Ωì": "#eab308"
        };

        // Ë°ùÁ™ÅÂõûÈÅø: Èáç„Å™„Çä„ÇíÊ§úÂá∫„Åó„ÄÅ‰∏ä‰ΩçÔºà„É©„É≥„ÇØÂ∞è„Åï„ÅÑÊñπÔºâ„ÇíÂè≥‰∏ä„Å´„Ç™„Éï„Çª„ÉÉ„Éà
        function resolveCollisions(data, xScale, yScale, baseRadius) {
            const positions = data.map(s => ({
                ...s,
                cx: xScale(s.certainty),
                cy: yScale(s.upside),
                offsetX: 0,
                offsetY: 0
            }));

            positions.sort((a, b) => a.rank - b.rank);
            const minDistance = baseRadius * 2.3;

            for (let i = 0; i < positions.length; i++) {
                for (let j = 0; j < i; j++) {
                    const dx = (positions[i].cx + positions[i].offsetX) - (positions[j].cx + positions[j].offsetX);
                    const dy = (positions[i].cy + positions[i].offsetY) - (positions[j].cy + positions[j].offsetY);
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < minDistance) {
                        const overlap = minDistance - distance;
                        positions[j].offsetX += overlap * 0.6 + 4;
                        positions[j].offsetY -= overlap * 0.5 + 3;
                    }
                }
            }

            return positions;
        }

        function QuadrantChart() {
            const [selectedStock, setSelectedStock] = React.useState(null);
            const [hoveredStock, setHoveredStock] = React.useState(null);
            const [selectedDomain, setSelectedDomain] = React.useState("all");

            const width = 1100;
            const height = 750;
            const margin = { top: 50, right: 40, bottom: 50, left: 55 };
            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;

            const xMin = 68, xMax = 102;
            const yMin = 25, yMax = 85;

            const xScale = (c) => margin.left + ((c - xMin) / (xMax - xMin)) * chartWidth;
            const yScale = (u) => margin.top + chartHeight - ((u - yMin) / (yMax - yMin)) * chartHeight;

            const certThreshold = 87;
            const upsideThreshold = 44;
            const baseRadius = 22; // Â§ßÂπÖ„Å´Êã°Â§ß

            const filteredData = selectedDomain === "all" ? japanTop30Data : japanTop30Data.filter(s => s.domain === selectedDomain);

            const allPositions = resolveCollisions(japanTop30Data, xScale, yScale, baseRadius);
            const positionMap = {};
            allPositions.forEach(p => { positionMap[p.ticker] = p; });

            const domains = [...new Set(japanTop30Data.map(s => s.domain))];

            const quadrantBgs = [
                { x: xScale(certThreshold), y: margin.top, w: xScale(xMax) - xScale(certThreshold), h: yScale(upsideThreshold) - margin.top, color: "rgba(34, 197, 94, 0.15)", label: "ÊúÄÂÑ™ÂÖà", sublabel: "È´òÁ¢∫ÂÆü√óÈ´ò„Ç¢„ÉÉ„Éó„Çµ„Ç§„Éâ" },
                { x: margin.left, y: margin.top, w: xScale(certThreshold) - margin.left, h: yScale(upsideThreshold) - margin.top, color: "rgba(249, 115, 22, 0.12)", label: "ÊäïÊ©üÁöÑ", sublabel: "‰ΩéÁ¢∫ÂÆü√óÈ´ò„Ç¢„ÉÉ„Éó„Çµ„Ç§„Éâ" },
                { x: xScale(certThreshold), y: yScale(upsideThreshold), w: xScale(xMax) - xScale(certThreshold), h: yScale(yMin) - yScale(upsideThreshold), color: "rgba(59, 130, 246, 0.12)", label: "ÂÆâÂÆö", sublabel: "È´òÁ¢∫ÂÆü√ó‰Ωé„Ç¢„ÉÉ„Éó„Çµ„Ç§„Éâ" },
                { x: margin.left, y: yScale(upsideThreshold), w: xScale(certThreshold) - margin.left, h: yScale(yMin) - yScale(upsideThreshold), color: "rgba(239, 68, 68, 0.08)", label: "ÊÖéÈáç", sublabel: "‰ΩéÁ¢∫ÂÆü√ó‰Ωé„Ç¢„ÉÉ„Éó„Çµ„Ç§„Éâ" }
            ];

            const counts = {
                prime: japanTop30Data.filter(s => s.certainty >= certThreshold && s.upside >= upsideThreshold).length,
                stable: japanTop30Data.filter(s => s.certainty >= certThreshold && s.upside < upsideThreshold).length,
                spec: japanTop30Data.filter(s => s.certainty < certThreshold && s.upside >= upsideThreshold).length,
                avoid: japanTop30Data.filter(s => s.certainty < certThreshold && s.upside < upsideThreshold).length
            };

            const sortedFilteredData = [...filteredData].sort((a, b) => b.rank - a.rank);

            // Ë°®Á§∫„Åô„Çã„Çπ„Éà„ÉÉ„ÇØÔºà„ÇØ„É™„ÉÉ„ÇØ„Åæ„Åü„ÅØ„Éõ„Éê„ÉºÔºâ
            const displayStock = selectedStock || hoveredStock;

            return (
                <div style={{ padding: "16px", maxWidth: "1200px", margin: "0 auto" }}>
                    <div style={{ textAlign: "center", marginBottom: "12px" }}>
                        <h1 style={{ fontSize: "24px", fontWeight: "bold", color: "#fff", marginBottom: "4px" }}>
                            üáØüáµ Japan Top 30 - 4Ë±°Èôê„Éû„Éà„É™„ÉÉ„ÇØ„Çπ
                        </h1>
                        <div style={{ display: "flex", justifyContent: "center", gap: "24px", fontSize: "13px", color: "#9ca3af" }}>
                            <span>Â∏ÇÂ†¥„É™„Çπ„ÇØ: <b style={{color: "#eab308"}}>57/100</b></span>
                            <span>„Çπ„Çø„É≥„Çπ: „Éê„É©„É≥„ÇπÂûã</span>
                            <span>Êõ¥Êñ∞: 2026-01-30</span>
                        </div>
                        <div style={{ fontSize: "11px", color: "#6b7280", marginTop: "4px" }}>
                            ‚Äª Ëª∏„ÅØ30Á§æÂÜÖ„Åß„ÅÆÁõ∏ÂØæ‰ΩçÁΩÆ | ÈñæÂÄ§: Á¢∫ÂÆüÊÄß87% / „Ç¢„ÉÉ„Éó„Çµ„Ç§„Éâ44%Ôºà‰∏≠Â§ÆÂÄ§Âü∫Ê∫ñÔºâ| „ÇØ„É™„ÉÉ„ÇØ„ÅßË©≥Á¥∞Âõ∫ÂÆö
                        </div>
                    </div>

                    <div style={{ display: "flex", flexWrap: "wrap", gap: "6px", marginBottom: "12px", justifyContent: "center" }}>
                        <button onClick={() => setSelectedDomain("all")} style={{
                            padding: "4px 12px", borderRadius: "16px", fontSize: "12px", cursor: "pointer",
                            border: selectedDomain === "all" ? "2px solid #fff" : "1px solid #4b5563",
                            background: selectedDomain === "all" ? "rgba(255,255,255,0.1)" : "transparent", color: "#fff"
                        }}>ÂÖ®„Å¶ ({japanTop30Data.length})</button>
                        {domains.map(d => (
                            <button key={d} onClick={() => setSelectedDomain(d)} style={{
                                padding: "4px 12px", borderRadius: "16px", fontSize: "12px", cursor: "pointer",
                                border: selectedDomain === d ? `2px solid ${domainColors[d]}` : "1px solid #4b5563",
                                background: selectedDomain === d ? `${domainColors[d]}30` : "transparent", color: domainColors[d]
                            }}>{d} ({japanTop30Data.filter(s => s.domain === d).length})</button>
                        ))}
                    </div>

                    <div style={{ display: "flex", gap: "16px" }}>
                        {/* „ÉÅ„É£„Éº„ÉàÈÉ®ÂàÜ */}
                        <div style={{ background: "rgba(30, 41, 59, 0.4)", borderRadius: "12px", padding: "12px", border: "1px solid rgba(255,255,255,0.1)", flex: "1" }}>
                            <svg width={width} height={height} style={{ display: "block", margin: "0 auto" }}
                                onClick={(e) => {
                                    if (e.target.tagName === 'svg' || e.target.tagName === 'rect' || e.target.tagName === 'line') {
                                        setSelectedStock(null);
                                    }
                                }}>

                                {quadrantBgs.map((q, i) => (
                                    <g key={i}>
                                        <rect x={q.x} y={q.y} width={q.w} height={q.h} fill={q.color} />
                                        <text x={q.x + q.w/2} y={q.y + 26} fill="rgba(255,255,255,0.4)" fontSize="18" textAnchor="middle" fontWeight="bold">{q.label}</text>
                                        <text x={q.x + q.w/2} y={q.y + 46} fill="rgba(255,255,255,0.25)" fontSize="11" textAnchor="middle">{q.sublabel}</text>
                                    </g>
                                ))}

                                {[70, 75, 80, 85, 90, 95, 100].map(v => (
                                    <line key={`xg${v}`} x1={xScale(v)} y1={margin.top} x2={xScale(v)} y2={height - margin.bottom} stroke="rgba(255,255,255,0.08)" />
                                ))}
                                {[30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80].map(v => (
                                    <line key={`yg${v}`} x1={margin.left} y1={yScale(v)} x2={width - margin.right} y2={yScale(v)} stroke="rgba(255,255,255,0.08)" />
                                ))}

                                <line x1={xScale(certThreshold)} y1={margin.top} x2={xScale(certThreshold)} y2={height - margin.bottom} stroke="rgba(255,255,255,0.4)" strokeWidth="2" strokeDasharray="8,4" />
                                <line x1={margin.left} y1={yScale(upsideThreshold)} x2={width - margin.right} y2={yScale(upsideThreshold)} stroke="rgba(255,255,255,0.4)" strokeWidth="2" strokeDasharray="8,4" />

                                <text x={width / 2} y={height - 10} fill="#9ca3af" fontSize="13" textAnchor="middle">Á¢∫ÂÆüÊÄß (Certainty) % ‚Üí</text>
                                <text x={18} y={height / 2} fill="#9ca3af" fontSize="13" textAnchor="middle" transform={`rotate(-90, 18, ${height / 2})`}>„Ç¢„ÉÉ„Éó„Çµ„Ç§„Éâ (Upside) % ‚Üí</text>

                                {[70, 75, 80, 85, 90, 95, 100].map(v => (
                                    <text key={`xt${v}`} x={xScale(v)} y={height - margin.bottom + 18} fill="#6b7280" fontSize="11" textAnchor="middle">{v}</text>
                                ))}
                                {[30, 40, 50, 60, 70, 80].map(v => (
                                    <text key={`yt${v}`} x={margin.left - 8} y={yScale(v) + 4} fill="#6b7280" fontSize="11" textAnchor="end">{v}</text>
                                ))}

                                {sortedFilteredData.map((s) => {
                                    const pos = positionMap[s.ticker];
                                    const cx = pos.cx + pos.offsetX;
                                    const cy = pos.cy + pos.offsetY;
                                    const isSelected = selectedStock?.ticker === s.ticker;
                                    const isHovered = hoveredStock?.ticker === s.ticker;
                                    const isActive = isSelected || isHovered;
                                    const isTop1 = s.rank === 1;
                                    const isTop15 = s.rank <= 15;
                                    const isHighMono = s.monopoly >= 26;
                                    const r = isActive ? baseRadius + 4 : baseRadius;

                                    const opacity = isTop15 ? 0.95 : 0.65;

                                    return (
                                        <g key={s.ticker}
                                            style={{ cursor: "pointer" }}
                                            onClick={(e) => {
                                                e.stopPropagation();
                                                setSelectedStock(isSelected ? null : s);
                                            }}
                                            onMouseEnter={() => setHoveredStock(s)}
                                            onMouseLeave={() => setHoveredStock(null)}>
                                            {isHighMono && <circle cx={cx} cy={cy} r={r + 8} fill="none" stroke="#ef4444" strokeWidth="2.5" strokeDasharray="5,3" opacity={isTop15 ? 0.8 : 0.5} />}
                                            {isTop1 && <circle cx={cx} cy={cy} r={r + 12} fill="rgba(234, 179, 8, 0.4)" />}
                                            <circle
                                                cx={cx} cy={cy} r={r}
                                                fill={domainColors[s.domain]}
                                                fillOpacity={isActive ? 1 : opacity}
                                                stroke={isSelected ? "#fff" : isTop1 ? "#fbbf24" : isHovered ? "#fff" : isTop15 ? "rgba(255,255,255,0.6)" : "rgba(255,255,255,0.35)"}
                                                strokeWidth={isSelected ? 4 : isTop1 ? 3.5 : isHovered ? 3 : isTop15 ? 2 : 1.5}
                                                style={{ transition: "all 0.15s" }}
                                            />
                                            <text
                                                x={cx} y={cy + 5}
                                                fill="#fff"
                                                fontSize={isTop15 ? "13" : "11"}
                                                textAnchor="middle"
                                                fontWeight="bold"
                                                style={{ pointerEvents: "none", textShadow: "0 1px 3px rgba(0,0,0,0.9)" }}
                                            >
                                                {s.rank}
                                            </text>
                                            {isActive && (
                                                <text x={cx} y={cy - r - 8} fill="#fff" fontSize="13" textAnchor="middle" fontWeight="bold"
                                                    style={{ pointerEvents: "none", textShadow: "0 2px 4px rgba(0,0,0,0.9)" }}>
                                                    {s.name}
                                                </text>
                                            )}
                                        </g>
                                    );
                                })}
                            </svg>
                        </div>

                        {/* Âè≥ÂÅ¥„ÅÆË©≥Á¥∞„Éë„Éç„É´ÔºàÂ∏∏„Å´Ë°®Á§∫„Ç®„É™„Ç¢„ÇíÁ¢∫‰øùÔºâ */}
                        <div style={{ width: "280px", flexShrink: 0 }}>
                            {displayStock ? (
                                <div style={{
                                    background: "rgba(15, 23, 42, 0.97)",
                                    border: `3px solid ${domainColors[displayStock.domain]}`,
                                    borderRadius: "12px",
                                    padding: "16px",
                                    boxShadow: "0 4px 20px rgba(0,0,0,0.5)"
                                }}>
                                    <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: "10px" }}>
                                        <div>
                                            <span style={{
                                                fontSize: "24px",
                                                fontWeight: "bold",
                                                color: displayStock.rank <= 15 ? "#22c55e" : "#9ca3af"
                                            }}>#{displayStock.rank}</span>
                                            <span style={{ fontSize: "18px", fontWeight: "bold", color: "#fff", marginLeft: "8px" }}>{displayStock.name}</span>
                                        </div>
                                        {selectedStock && (
                                            <button onClick={() => setSelectedStock(null)} style={{
                                                background: "rgba(255,255,255,0.1)",
                                                border: "none",
                                                borderRadius: "50%",
                                                width: "24px",
                                                height: "24px",
                                                color: "#9ca3af",
                                                cursor: "pointer",
                                                fontSize: "14px"
                                            }}>‚úï</button>
                                        )}
                                    </div>
                                    <div style={{
                                        display: "inline-block",
                                        padding: "3px 10px",
                                        background: `${domainColors[displayStock.domain]}30`,
                                        borderRadius: "12px",
                                        color: domainColors[displayStock.domain],
                                        fontSize: "12px",
                                        marginBottom: "10px"
                                    }}>{displayStock.domain}</div>
                                    <div style={{ color: "#9ca3af", marginBottom: "12px", fontSize: "12px" }}>
                                        {displayStock.ticker} | {displayStock.core_tech}
                                    </div>

                                    <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: "8px", marginBottom: "12px" }}>
                                        <div style={{ background: "rgba(34, 197, 94, 0.1)", padding: "8px", borderRadius: "6px" }}>
                                            <div style={{ fontSize: "10px", color: "#9ca3af" }}>Áã¨Âç†Âäõ</div>
                                            <div style={{ fontSize: "16px", fontWeight: "bold", color: "#22c55e" }}>{displayStock.monopoly}/30</div>
                                        </div>
                                        <div style={{ background: "rgba(59, 130, 246, 0.1)", padding: "8px", borderRadius: "6px" }}>
                                            <div style={{ fontSize: "10px", color: "#9ca3af" }}>ÊîøÁ≠ñËÄêÊÄß</div>
                                            <div style={{ fontSize: "16px", fontWeight: "bold", color: "#3b82f6" }}>{displayStock.resilience}/20</div>
                                        </div>
                                        <div style={{ background: "rgba(168, 85, 247, 0.1)", padding: "8px", borderRadius: "6px" }}>
                                            <div style={{ fontSize: "10px", color: "#9ca3af" }}>„Ç∑„Éä„Ç∏„Éº</div>
                                            <div style={{ fontSize: "16px", fontWeight: "bold", color: "#a855f7" }}>{displayStock.synergy}/25</div>
                                        </div>
                                        <div style={{ background: "rgba(249, 115, 22, 0.1)", padding: "8px", borderRadius: "6px" }}>
                                            <div style={{ fontSize: "10px", color: "#9ca3af" }}>ÈùûÂØæÁß∞ÊÄß</div>
                                            <div style={{ fontSize: "16px", fontWeight: "bold", color: "#f97316" }}>{displayStock.asymmetry}/15</div>
                                        </div>
                                        <div style={{ background: "rgba(236, 72, 153, 0.1)", padding: "8px", borderRadius: "6px" }}>
                                            <div style={{ fontSize: "10px", color: "#9ca3af" }}>Ë≥áÊú¨ÂäπÁéá</div>
                                            <div style={{ fontSize: "16px", fontWeight: "bold", color: "#ec4899" }}>{displayStock.capital}/10</div>
                                        </div>
                                        <div style={{ background: "rgba(234, 179, 8, 0.15)", padding: "8px", borderRadius: "6px" }}>
                                            <div style={{ fontSize: "10px", color: "#9ca3af" }}>ÂêàË®à„Çπ„Ç≥„Ç¢</div>
                                            <div style={{ fontSize: "16px", fontWeight: "bold", color: "#fbbf24" }}>{displayStock.total}/100</div>
                                        </div>
                                    </div>

                                    <div style={{ display: "flex", gap: "16px", marginBottom: "12px", padding: "10px", background: "rgba(255,255,255,0.05)", borderRadius: "6px" }}>
                                        <div>
                                            <div style={{ fontSize: "10px", color: "#9ca3af" }}>Á¢∫ÂÆüÊÄß</div>
                                            <div style={{ fontSize: "18px", fontWeight: "bold", color: "#fff" }}>{displayStock.certainty}%</div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: "10px", color: "#9ca3af" }}>„Ç¢„ÉÉ„Éó„Çµ„Ç§„Éâ</div>
                                            <div style={{ fontSize: "18px", fontWeight: "bold", color: "#fff" }}>{displayStock.upside}%</div>
                                        </div>
                                    </div>

                                    <div style={{ fontSize: "12px", color: "#d1d5db", lineHeight: 1.5, borderTop: "1px solid #374151", paddingTop: "12px" }}>
                                        {displayStock.thesis}
                                    </div>

                                    {displayStock.rank > 15 && (
                                        <div style={{ marginTop: "12px", padding: "8px 12px", background: "rgba(249, 115, 22, 0.2)", borderRadius: "6px", fontSize: "11px", color: "#f97316" }}>
                                            ‚ö† 16‰Ωç‰ª•‰∏ãÔºöÊîª„ÇÅ„ÅÆÂßøÂã¢ÊôÇ„ÅÆ„ÅøÊ§úË®é
                                        </div>
                                    )}
                                </div>
                            ) : (
                                <div style={{
                                    background: "rgba(30, 41, 59, 0.4)",
                                    border: "1px dashed rgba(255,255,255,0.2)",
                                    borderRadius: "12px",
                                    padding: "24px",
                                    textAlign: "center",
                                    color: "#6b7280"
                                }}>
                                    <div style={{ fontSize: "14px", marginBottom: "8px" }}>„Éê„Éñ„É´„Çí„ÇØ„É™„ÉÉ„ÇØ„Åæ„Åü„ÅØ„Éõ„Éê„Éº</div>
                                    <div style={{ fontSize: "12px" }}>„ÅßË©≥Á¥∞„ÇíË°®Á§∫</div>
                                </div>
                            )}
                        </div>
                    </div>

                    <div style={{ display: "flex", justifyContent: "center", gap: "20px", marginTop: "12px", fontSize: "12px", flexWrap: "wrap" }}>
                        <div style={{ display: "flex", alignItems: "center", gap: "16px" }}>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px" }}>
                                <span style={{ width: "14px", height: "14px", background: "#22c55e", borderRadius: "50%", opacity: 0.9 }}></span>
                                ÊúÄÂÑ™ÂÖà: {counts.prime}
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px" }}>
                                <span style={{ width: "14px", height: "14px", background: "#3b82f6", borderRadius: "50%", opacity: 0.9 }}></span>
                                ÂÆâÂÆö: {counts.stable}
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px" }}>
                                <span style={{ width: "14px", height: "14px", background: "#f97316", borderRadius: "50%", opacity: 0.9 }}></span>
                                ÊäïÊ©üÁöÑ: {counts.spec}
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px" }}>
                                <span style={{ width: "14px", height: "14px", background: "#ef4444", borderRadius: "50%", opacity: 0.9 }}></span>
                                ÊÖéÈáç: {counts.avoid}
                            </span>
                        </div>
                        <span style={{ color: "#4b5563" }}>|</span>
                        <div style={{ display: "flex", alignItems: "center", gap: "12px" }}>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px", color: "#9ca3af" }}>
                                <span style={{ width: "16px", height: "16px", border: "2.5px dashed #ef4444", borderRadius: "50%" }}></span>
                                È´òÁã¨Âç† (‚â•26)
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px", color: "#9ca3af" }}>
                                <span style={{ width: "16px", height: "16px", background: "rgba(234, 179, 8, 0.4)", borderRadius: "50%", border: "3px solid #fbbf24" }}></span>
                                #1
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px", color: "#6b7280" }}>
                                <span style={{ width: "14px", height: "14px", background: "#6b7280", borderRadius: "50%", opacity: 0.5 }}></span>
                                16‰Ωç‰ª•‰∏ã
                            </span>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<QuadrantChart />);
    </script>
</body>
</html>
