<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japan Top 30 - 4è±¡é™ãƒãƒˆãƒªãƒƒã‚¯ã‚¹</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
        }
        #root { width: 100%; min-height: 100vh; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const japanTop30Data = [
            { rank: 1, ticker: "7011.T", name: "ä¸‰è±é‡å·¥æ¥­", certainty: 95, upside: 45, total: 88, monopoly: 28, resilience: 19, synergy: 22, asymmetry: 12, capital: 7, domain: "é˜²è¡›", core_tech: "é˜²è¡›è£…å‚™å“ã€åŸå­åŠ›ã€èˆªç©ºå®‡å®™", thesis: "é˜²è¡›è£…å‚™å“å¥‘ç´„é¦–ä½ï¼ˆ1å…†4,567å„„å††ï¼‰ã€‚å—æ³¨1.87å…†å††ã€‚æ—¥è‹±ä¼Šæ¬¡æœŸæˆ¦é—˜æ©Ÿå…±åŒé–‹ç™ºã€‚é˜²è¡›è²»9å…†å††è¶…ã§æœ€å¤§å—ç›Šè€…ã€‚" },
            { rank: 2, ticker: "8035.T", name: "æ±äº¬ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­ãƒ³", certainty: 95, upside: 40, total: 86, monopoly: 27, resilience: 17, synergy: 22, asymmetry: 12, capital: 8, domain: "åŠå°ä½“", core_tech: "åŠå°ä½“è£½é€ è£…ç½®", thesis: "ã‚³ãƒ¼ã‚¿/ãƒ‡ãƒ™ãƒ­ãƒƒãƒ‘ä¸–ç•Œé¦–ä½ã€‚AIåŠå°ä½“éœ€è¦ç¶™ç¶šã€‚" },
            { rank: 3, ticker: "6954.T", name: "ãƒ•ã‚¡ãƒŠãƒƒã‚¯", certainty: 99, upside: 45, total: 85, monopoly: 26, resilience: 17, synergy: 21, asymmetry: 14, capital: 7, domain: "ãƒ­ãƒœãƒ†ã‚£ã‚¯ã‚¹", core_tech: "CNCã€ç”£æ¥­ç”¨ãƒ­ãƒœãƒƒãƒˆ", thesis: "CNCä¸–ç•Œé¦–ä½ã€‚Q3ãƒ­ãƒœãƒƒãƒˆå—æ³¨+38%ã€‚CRX-H1ãƒ’ãƒ¥ãƒ¼ãƒãƒã‚¤ãƒ‰2026å¹´H2é‡ç”£ã€‚" },
            { rank: 4, ticker: "6501.T", name: "æ—¥ç«‹è£½ä½œæ‰€", certainty: 90, upside: 42, total: 82, monopoly: 25, resilience: 17, synergy: 21, asymmetry: 11, capital: 8, domain: "ã‚¨ãƒãƒ«ã‚®ãƒ¼", core_tech: "ã‚°ãƒªãƒƒãƒ‰ã€HVDC", thesis: "ã‚°ãƒªãƒƒãƒ‰å¤‰åœ§å™¨40%ã‚·ã‚§ã‚¢ã€‚BWRX-300ã§SMRå¸‚å ´å‚å…¥ã€‚" },
            { rank: 5, ticker: "9432.T", name: "NTT", certainty: 90, upside: 30, total: 80, monopoly: 25, resilience: 18, synergy: 18, asymmetry: 10, capital: 9, domain: "AI", core_tech: "ãƒ‡ãƒ¼ã‚¿ã‚»ãƒ³ã‚¿ãƒ¼ã€IOWN", thesis: "å›½å†…DC60%ã‚·ã‚§ã‚¢ã€‚IOWNé‡å­å®‰å…¨æŠ€è¡“ã€‚" },
            { rank: 6, ticker: "6506.T", name: "å®‰å·é›»æ©Ÿ", certainty: 95, upside: 42, total: 79, monopoly: 24, resilience: 16, synergy: 20, asymmetry: 11, capital: 8, domain: "ãƒ­ãƒœãƒ†ã‚£ã‚¯ã‚¹", core_tech: "ã‚µãƒ¼ãƒœãƒ¢ãƒ¼ã‚¿", thesis: "ã‚µãƒ¼ãƒœãƒ¢ãƒ¼ã‚¿ä¸–ç•Œé¦–ä½ã€‚MOTOMAN-HMãƒ’ãƒ¥ãƒ¼ãƒãƒã‚¤ãƒ‰é–‹ç™ºä¸­ã€‚" },
            { rank: 7, ticker: "6701.T", name: "NEC", certainty: 95, upside: 45, total: 78, monopoly: 23, resilience: 18, synergy: 18, asymmetry: 11, capital: 8, domain: "ã‚µã‚¤ãƒãƒ¼", core_tech: "ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£", thesis: "æ”¿åºœå‘ã‘ã‚µã‚¤ãƒãƒ¼ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã€‚Protect.jpè¨­ç«‹ã€‚" },
            { rank: 8, ticker: "7012.T", name: "å·å´é‡å·¥æ¥­", certainty: 90, upside: 42, total: 76, monopoly: 24, resilience: 17, synergy: 18, asymmetry: 10, capital: 7, domain: "é˜²è¡›", core_tech: "é˜²è¡›è£…å‚™å“ã€èˆªç©ºå®‡å®™", thesis: "é˜²è¡›è£…å‚™å“å¥‘ç´„2ä½ã€‚æ¬¡æœŸæˆ¦é—˜æ©Ÿå‚ç”»ã€‚" },
            { rank: 9, ticker: "7013.T", name: "IHI", certainty: 90, upside: 48, total: 75, monopoly: 23, resilience: 17, synergy: 18, asymmetry: 10, capital: 7, domain: "ã‚¨ãƒãƒ«ã‚®ãƒ¼", core_tech: "èˆªç©ºã‚¨ãƒ³ã‚¸ãƒ³ã€SMR", thesis: "NuScale SMRãƒ‘ãƒ¼ãƒˆãƒŠãƒ¼ã€‚èˆªç©ºã‚¨ãƒ³ã‚¸ãƒ³éƒ¨å“ã€‚" },
            { rank: 10, ticker: "186A.T", name: "Astroscale", certainty: 85, upside: 80, total: 74, monopoly: 26, resilience: 14, synergy: 17, asymmetry: 13, capital: 4, domain: "å®‡å®™", core_tech: "ãƒ‡ãƒ–ãƒªé™¤å»", thesis: "è»Œé“ä¸Šã‚µãƒ¼ãƒ“ã‚¹ä¸–ç•Œãƒªãƒ¼ãƒ€ãƒ¼ã€‚ãƒ‡ãƒ–ãƒªé™¤å»å”¯ä¸€ã®å®Ÿç¸¾ã€‚" },
            { rank: 11, ticker: "6920.T", name: "ãƒ¬ãƒ¼ã‚¶ãƒ¼ãƒ†ãƒƒã‚¯", certainty: 90, upside: 55, total: 73, monopoly: 28, resilience: 14, synergy: 18, asymmetry: 8, capital: 5, domain: "åŠå°ä½“", core_tech: "EUVãƒã‚¹ã‚¯æ¤œæŸ»", thesis: "EUVãƒã‚¹ã‚¯æ¤œæŸ»ã‚·ã‚§ã‚¢100%ã€‚" },
            { rank: 12, ticker: "6857.T", name: "ã‚¢ãƒ‰ãƒãƒ³ãƒ†ã‚¹ãƒˆ", certainty: 90, upside: 45, total: 72, monopoly: 24, resilience: 16, synergy: 18, asymmetry: 7, capital: 7, domain: "åŠå°ä½“", core_tech: "åŠå°ä½“ãƒ†ã‚¹ã‚¿ãƒ¼", thesis: "SoCãƒ†ã‚¹ã‚¿ãƒ¼ä¸–ç•Œé¦–ä½ã€‚HBMãƒ†ã‚¹ãƒˆéœ€è¦æ€¥å¢—ã€‚" },
            { rank: 13, ticker: "6861.T", name: "ã‚­ãƒ¼ã‚¨ãƒ³ã‚¹", certainty: 92, upside: 35, total: 71, monopoly: 24, resilience: 16, synergy: 17, asymmetry: 6, capital: 8, domain: "ãƒ­ãƒœãƒ†ã‚£ã‚¯ã‚¹", core_tech: "FAã‚»ãƒ³ã‚µãƒ¼", thesis: "FAç”¨ã‚»ãƒ³ã‚µãƒ¼ä¸–ç•Œãƒˆãƒƒãƒ—ã€‚å–¶æ¥­åˆ©ç›Šç‡50%è¶…ã€‚" },
            { rank: 14, ticker: "7735.T", name: "SCREEN", certainty: 88, upside: 45, total: 70, monopoly: 25, resilience: 15, synergy: 17, asymmetry: 6, capital: 7, domain: "åŠå°ä½“", core_tech: "æ´—æµ„è£…ç½®", thesis: "ã‚¦ã‚§ãƒ¼ãƒæ´—æµ„è£…ç½®ä¸–ç•Œé¦–ä½ã€‚" },
            { rank: 15, ticker: "6273.T", name: "SMC", certainty: 90, upside: 38, total: 69, monopoly: 26, resilience: 15, synergy: 15, asymmetry: 6, capital: 7, domain: "ãƒ­ãƒœãƒ†ã‚£ã‚¯ã‚¹", core_tech: "ç©ºåœ§æ©Ÿå™¨", thesis: "ç©ºåœ§æ©Ÿå™¨ä¸–ç•Œã‚·ã‚§ã‚¢40%ã€‚" },
            { rank: 16, ticker: "6503.T", name: "ä¸‰è±é›»æ©Ÿ", certainty: 88, upside: 40, total: 68, monopoly: 22, resilience: 17, synergy: 17, asymmetry: 6, capital: 6, domain: "é˜²è¡›", core_tech: "é˜²è¡›ã‚¨ãƒ¬ã‚¯ãƒˆãƒ­ãƒ‹ã‚¯ã‚¹", thesis: "ãƒ¬ãƒ¼ãƒ€ãƒ¼ã€èª˜å°è£…ç½®ã§å¼·ã¿ã€‚" },
            { rank: 17, ticker: "6702.T", name: "å¯Œå£«é€š", certainty: 85, upside: 42, total: 67, monopoly: 21, resilience: 17, synergy: 17, asymmetry: 6, capital: 6, domain: "ã‚µã‚¤ãƒãƒ¼", core_tech: "é‡å­ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿", thesis: "å›½ç”£é‡å­ã‚³ãƒ³ãƒ”ãƒ¥ãƒ¼ã‚¿é–‹ç™ºã€‚å¯Œå²³å¾Œç¶™æ©Ÿã€‚" },
            { rank: 18, ticker: "9433.T", name: "KDDI", certainty: 90, upside: 32, total: 66, monopoly: 22, resilience: 17, synergy: 16, asymmetry: 5, capital: 6, domain: "ã‚µã‚¤ãƒãƒ¼", core_tech: "é€šä¿¡ã‚¤ãƒ³ãƒ•ãƒ©", thesis: "Protect.jpè¨­ç«‹ã€‚5Gãƒ»AIéœ€è¦ã€‚" },
            { rank: 19, ticker: "6758.T", name: "ã‚½ãƒ‹ãƒ¼", certainty: 88, upside: 35, total: 65, monopoly: 24, resilience: 15, synergy: 16, asymmetry: 4, capital: 6, domain: "AI", core_tech: "ã‚¤ãƒ¡ãƒ¼ã‚¸ã‚»ãƒ³ã‚µãƒ¼", thesis: "CMOSã‚»ãƒ³ã‚µãƒ¼ä¸–ç•Œã‚·ã‚§ã‚¢50%ã€‚" },
            { rank: 20, ticker: "5631.T", name: "æ—¥æœ¬è£½é‹¼æ‰€", certainty: 85, upside: 50, total: 64, monopoly: 26, resilience: 16, synergy: 14, asymmetry: 4, capital: 4, domain: "ã‚¨ãƒãƒ«ã‚®ãƒ¼", core_tech: "åŸå­åŠ›åœ§åŠ›å®¹å™¨", thesis: "åŸå­åŠ›åœ§åŠ›å®¹å™¨ä¸–ç•Œã‚·ã‚§ã‚¢80%ã€‚" },
            { rank: 21, ticker: "6141.T", name: "DMGæ£®ç²¾æ©Ÿ", certainty: 85, upside: 42, total: 63, monopoly: 22, resilience: 15, synergy: 16, asymmetry: 5, capital: 5, domain: "é˜²è¡›", core_tech: "5è»¸åŠ å·¥æ©Ÿ", thesis: "èˆªç©ºå®‡å®™ãƒ»é˜²è¡›å‘ã‘é«˜ç²¾åº¦åŠ å·¥ã€‚" },
            { rank: 22, ticker: "6645.T", name: "ã‚ªãƒ ãƒ­ãƒ³", certainty: 85, upside: 40, total: 62, monopoly: 21, resilience: 15, synergy: 16, asymmetry: 5, capital: 5, domain: "ãƒ­ãƒœãƒ†ã‚£ã‚¯ã‚¹", core_tech: "FAåˆ¶å¾¡æ©Ÿå™¨", thesis: "å”åƒãƒ­ãƒœãƒƒãƒˆã€è‡ªå¾‹ç§»å‹•ãƒ­ãƒœãƒƒãƒˆã€‚" },
            { rank: 23, ticker: "6723.T", name: "ãƒ«ãƒã‚µã‚¹", certainty: 85, upside: 45, total: 61, monopoly: 22, resilience: 14, synergy: 16, asymmetry: 4, capital: 5, domain: "AI", core_tech: "è»Šè¼‰åŠå°ä½“", thesis: "è»Šè¼‰ãƒã‚¤ã‚³ãƒ³ä¸–ç•Œé¦–ä½ç´šã€‚" },
            { rank: 24, ticker: "6807.T", name: "æ—¥æœ¬èˆªç©ºé›»å­", certainty: 85, upside: 45, total: 60, monopoly: 22, resilience: 16, synergy: 14, asymmetry: 4, capital: 4, domain: "é˜²è¡›", core_tech: "ã‚³ãƒã‚¯ã‚¿", thesis: "èˆªç©ºãƒ»é˜²è¡›å‘ã‘é«˜ä¿¡é ¼æ€§ã‚³ãƒã‚¯ã‚¿ã€‚" },
            { rank: 25, ticker: "6361.T", name: "èåŸè£½ä½œæ‰€", certainty: 85, upside: 42, total: 59, monopoly: 22, resilience: 15, synergy: 14, asymmetry: 4, capital: 4, domain: "ã‚¨ãƒãƒ«ã‚®ãƒ¼", core_tech: "åŸå­åŠ›ãƒãƒ³ãƒ—", thesis: "åŸå­åŠ›ãƒãƒ³ãƒ—å›½å†…ç‹¬å ã€‚CMPè£…ç½®ã€‚" },
            { rank: 26, ticker: "9501.T", name: "æ±äº¬é›»åŠ›", certainty: 70, upside: 65, total: 58, monopoly: 24, resilience: 12, synergy: 12, asymmetry: 6, capital: 4, domain: "ã‚¨ãƒãƒ«ã‚®ãƒ¼", core_tech: "åŸå­åŠ›ç™ºé›»", thesis: "æŸå´åˆˆç¾½7åŸºã€‚å†ç¨¼åƒã§åç›Šæ”¹å–„ã€‚" },
            { rank: 27, ticker: "7224.T", name: "æ–°æ˜å’Œå·¥æ¥­", certainty: 82, upside: 48, total: 57, monopoly: 24, resilience: 16, synergy: 11, asymmetry: 4, capital: 2, domain: "é˜²è¡›", core_tech: "é£›è¡Œè‰‡", thesis: "US-2æ•‘é›£é£›è¡Œè‰‡ã§ä¸–ç•Œå”¯ä¸€ã€‚" },
            { rank: 28, ticker: "7739.T", name: "ã‚­ãƒ¤ãƒãƒ³é›»å­", certainty: 78, upside: 55, total: 56, monopoly: 20, resilience: 14, synergy: 14, asymmetry: 5, capital: 3, domain: "å®‡å®™", core_tech: "å°å‹è¡›æ˜Ÿ", thesis: "ã‚¹ãƒšãƒ¼ã‚¹ãƒ¯ãƒ³å‡ºè³‡ã€‚å®‡å®™äº‹æ¥­æ‹¡å¤§ã€‚" },
            { rank: 29, ticker: "1963.T", name: "æ—¥æ®HD", certainty: 82, upside: 45, total: 55, monopoly: 21, resilience: 14, synergy: 13, asymmetry: 4, capital: 3, domain: "ã‚¨ãƒãƒ«ã‚®ãƒ¼", core_tech: "LNGãƒ—ãƒ©ãƒ³ãƒˆ", thesis: "LNG EPCä¸–ç•Œãƒˆãƒƒãƒ—3ã€‚æ°´ç´ é–¢é€£ã€‚" },
            { rank: 30, ticker: "6779.T", name: "æ—¥æœ¬é›»æ³¢", certainty: 80, upside: 48, total: 54, monopoly: 22, resilience: 13, synergy: 12, asymmetry: 4, capital: 3, domain: "å®‡å®™", core_tech: "æ°´æ™¶ãƒ‡ãƒã‚¤ã‚¹", thesis: "å®‡å®™ãƒ»é˜²è¡›å‘ã‘è€æ”¾å°„ç·šãƒ‡ãƒã‚¤ã‚¹ã€‚" }
        ];

        const domainColors = {
            "AI": "#a855f7", "é˜²è¡›": "#3b82f6", "ã‚¨ãƒãƒ«ã‚®ãƒ¼": "#22c55e",
            "ãƒ­ãƒœãƒ†ã‚£ã‚¯ã‚¹": "#f97316", "å®‡å®™": "#06b6d4", "ã‚µã‚¤ãƒãƒ¼": "#ec4899", "åŠå°ä½“": "#eab308"
        };

        // è¡çªå›é¿: é‡ãªã‚Šã‚’æ¤œå‡ºã—ã€ä¸Šä½ï¼ˆãƒ©ãƒ³ã‚¯å°ã•ã„æ–¹ï¼‰ã‚’å³ä¸Šã«ã‚ªãƒ•ã‚»ãƒƒãƒˆ
        function resolveCollisions(data, xScale, yScale, baseRadius) {
            const positions = data.map(s => ({
                ...s,
                cx: xScale(s.certainty),
                cy: yScale(s.upside),
                offsetX: 0,
                offsetY: 0
            }));

            // ãƒ©ãƒ³ã‚¯é †ã«ã‚½ãƒ¼ãƒˆï¼ˆå°ã•ã„é † = ä¸Šä½é †ï¼‰
            positions.sort((a, b) => a.rank - b.rank);

            const minDistance = baseRadius * 2.6;

            // å„ãƒãƒ–ãƒ«ã«ã¤ã„ã¦ã€ã‚ˆã‚Šä¸Šä½ã®ãƒãƒ–ãƒ«ã¨ã®è¡çªã‚’ãƒã‚§ãƒƒã‚¯
            for (let i = 0; i < positions.length; i++) {
                for (let j = 0; j < i; j++) {
                    const dx = (positions[i].cx + positions[i].offsetX) - (positions[j].cx + positions[j].offsetX);
                    const dy = (positions[i].cy + positions[i].offsetY) - (positions[j].cy + positions[j].offsetY);
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < minDistance) {
                        const overlap = minDistance - distance;
                        // ä¸Šä½ã®ãƒãƒ–ãƒ«(j)ã‚’å³ä¸Šæ–¹å‘ã«ã‚ªãƒ•ã‚»ãƒƒãƒˆ
                        positions[j].offsetX += overlap * 0.5 + 2;
                        positions[j].offsetY -= overlap * 0.4 + 1;
                    }
                }
            }

            return positions;
        }

        function QuadrantChart() {
            const [hoveredStock, setHoveredStock] = React.useState(null);
            const [selectedDomain, setSelectedDomain] = React.useState("all");
            const [mousePos, setMousePos] = React.useState({ x: 0, y: 0 });

            const width = 1100;
            const height = 750;
            const margin = { top: 50, right: 40, bottom: 50, left: 55 };
            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;

            // 30ç¤¾ã®ç›¸å¯¾çš„ãªä½ç½®é–¢ä¿‚ã‚’è¦‹ã‚„ã™ãã™ã‚‹ãŸã‚ã€ã‚¹ã‚±ãƒ¼ãƒ«ã‚’ãƒ‡ãƒ¼ã‚¿ç¯„å›²ã«åˆã‚ã›ã‚‹
            // Certainty: 70-100 (å®Ÿãƒ‡ãƒ¼ã‚¿70-99)
            // Upside: 25-85 (å®Ÿãƒ‡ãƒ¼ã‚¿30-80)
            const xMin = 68, xMax = 102;
            const yMin = 25, yMax = 85;

            const xScale = (c) => margin.left + ((c - xMin) / (xMax - xMin)) * chartWidth;
            const yScale = (u) => margin.top + chartHeight - ((u - yMin) / (yMax - yMin)) * chartHeight;

            // ä¸­å¤®å€¤ã‚’é–¾å€¤ã¨ã—ã¦ä½¿ç”¨ï¼ˆ30ç¤¾å†…ã§ã®ç›¸å¯¾çš„ãªåŸºæº–ï¼‰
            const certThreshold = 87;  // certaintyã®ä¸­å¤®å€¤ä»˜è¿‘
            const upsideThreshold = 44; // upsideã®ä¸­å¤®å€¤ä»˜è¿‘
            const baseRadius = 14;

            const filteredData = selectedDomain === "all" ? japanTop30Data : japanTop30Data.filter(s => s.domain === selectedDomain);

            const allPositions = resolveCollisions(japanTop30Data, xScale, yScale, baseRadius);
            const positionMap = {};
            allPositions.forEach(p => { positionMap[p.ticker] = p; });

            const domains = [...new Set(japanTop30Data.map(s => s.domain))];

            const quadrantBgs = [
                { x: xScale(certThreshold), y: margin.top, w: xScale(xMax) - xScale(certThreshold), h: yScale(upsideThreshold) - margin.top, color: "rgba(34, 197, 94, 0.15)", label: "æœ€å„ªå…ˆ", sublabel: "é«˜ç¢ºå®ŸÃ—é«˜ã‚¢ãƒƒãƒ—ã‚µã‚¤ãƒ‰" },
                { x: margin.left, y: margin.top, w: xScale(certThreshold) - margin.left, h: yScale(upsideThreshold) - margin.top, color: "rgba(249, 115, 22, 0.12)", label: "æŠ•æ©Ÿçš„", sublabel: "ä½ç¢ºå®ŸÃ—é«˜ã‚¢ãƒƒãƒ—ã‚µã‚¤ãƒ‰" },
                { x: xScale(certThreshold), y: yScale(upsideThreshold), w: xScale(xMax) - xScale(certThreshold), h: yScale(yMin) - yScale(upsideThreshold), color: "rgba(59, 130, 246, 0.12)", label: "å®‰å®š", sublabel: "é«˜ç¢ºå®ŸÃ—ä½ã‚¢ãƒƒãƒ—ã‚µã‚¤ãƒ‰" },
                { x: margin.left, y: yScale(upsideThreshold), w: xScale(certThreshold) - margin.left, h: yScale(yMin) - yScale(upsideThreshold), color: "rgba(239, 68, 68, 0.08)", label: "æ…é‡", sublabel: "ä½ç¢ºå®ŸÃ—ä½ã‚¢ãƒƒãƒ—ã‚µã‚¤ãƒ‰" }
            ];

            const counts = {
                prime: japanTop30Data.filter(s => s.certainty >= certThreshold && s.upside >= upsideThreshold).length,
                stable: japanTop30Data.filter(s => s.certainty >= certThreshold && s.upside < upsideThreshold).length,
                spec: japanTop30Data.filter(s => s.certainty < certThreshold && s.upside >= upsideThreshold).length,
                avoid: japanTop30Data.filter(s => s.certainty < certThreshold && s.upside < upsideThreshold).length
            };

            // ãƒ©ãƒ³ã‚¯é †ã§ã‚½ãƒ¼ãƒˆï¼ˆä¸‹ä½ã‹ã‚‰æç”»ã—ã€ä¸Šä½ãŒæ‰‹å‰ã«æ¥ã‚‹ã‚ˆã†ã«ï¼‰
            const sortedFilteredData = [...filteredData].sort((a, b) => b.rank - a.rank);

            return (
                <div style={{ padding: "16px", maxWidth: "1200px", margin: "0 auto" }}>
                    <div style={{ textAlign: "center", marginBottom: "12px" }}>
                        <h1 style={{ fontSize: "24px", fontWeight: "bold", color: "#fff", marginBottom: "4px" }}>
                            ğŸ‡¯ğŸ‡µ Japan Top 30 - 4è±¡é™ãƒãƒˆãƒªãƒƒã‚¯ã‚¹
                        </h1>
                        <div style={{ display: "flex", justifyContent: "center", gap: "24px", fontSize: "13px", color: "#9ca3af" }}>
                            <span>å¸‚å ´ãƒªã‚¹ã‚¯: <b style={{color: "#eab308"}}>57/100</b></span>
                            <span>ã‚¹ã‚¿ãƒ³ã‚¹: ãƒãƒ©ãƒ³ã‚¹å‹</span>
                            <span>æ›´æ–°: 2026-01-30</span>
                        </div>
                        <div style={{ fontSize: "11px", color: "#6b7280", marginTop: "4px" }}>
                            â€» è»¸ã¯30ç¤¾å†…ã§ã®ç›¸å¯¾ä½ç½® | é–¾å€¤: ç¢ºå®Ÿæ€§87% / ã‚¢ãƒƒãƒ—ã‚µã‚¤ãƒ‰44%ï¼ˆä¸­å¤®å€¤åŸºæº–ï¼‰
                        </div>
                    </div>

                    <div style={{ display: "flex", flexWrap: "wrap", gap: "6px", marginBottom: "12px", justifyContent: "center" }}>
                        <button onClick={() => setSelectedDomain("all")} style={{
                            padding: "4px 12px", borderRadius: "16px", fontSize: "12px", cursor: "pointer",
                            border: selectedDomain === "all" ? "2px solid #fff" : "1px solid #4b5563",
                            background: selectedDomain === "all" ? "rgba(255,255,255,0.1)" : "transparent", color: "#fff"
                        }}>å…¨ã¦ ({japanTop30Data.length})</button>
                        {domains.map(d => (
                            <button key={d} onClick={() => setSelectedDomain(d)} style={{
                                padding: "4px 12px", borderRadius: "16px", fontSize: "12px", cursor: "pointer",
                                border: selectedDomain === d ? `2px solid ${domainColors[d]}` : "1px solid #4b5563",
                                background: selectedDomain === d ? `${domainColors[d]}30` : "transparent", color: domainColors[d]
                            }}>{d} ({japanTop30Data.filter(s => s.domain === d).length})</button>
                        ))}
                    </div>

                    <div style={{ background: "rgba(30, 41, 59, 0.4)", borderRadius: "12px", padding: "12px", border: "1px solid rgba(255,255,255,0.1)" }}>
                        <svg width={width} height={height} onMouseMove={(e) => {
                            const rect = e.currentTarget.getBoundingClientRect();
                            setMousePos({ x: e.clientX - rect.left, y: e.clientY - rect.top });
                        }} style={{ display: "block", margin: "0 auto" }}>

                            {quadrantBgs.map((q, i) => (
                                <g key={i}>
                                    <rect x={q.x} y={q.y} width={q.w} height={q.h} fill={q.color} />
                                    <text x={q.x + q.w/2} y={q.y + 22} fill="rgba(255,255,255,0.35)" fontSize="15" textAnchor="middle" fontWeight="bold">{q.label}</text>
                                    <text x={q.x + q.w/2} y={q.y + 38} fill="rgba(255,255,255,0.2)" fontSize="10" textAnchor="middle">{q.sublabel}</text>
                                </g>
                            ))}

                            {/* ã‚°ãƒªãƒƒãƒ‰ç·š */}
                            {[70, 75, 80, 85, 90, 95, 100].map(v => (
                                <line key={`xg${v}`} x1={xScale(v)} y1={margin.top} x2={xScale(v)} y2={height - margin.bottom} stroke="rgba(255,255,255,0.08)" />
                            ))}
                            {[30, 35, 40, 45, 50, 55, 60, 65, 70, 75, 80].map(v => (
                                <line key={`yg${v}`} x1={margin.left} y1={yScale(v)} x2={width - margin.right} y2={yScale(v)} stroke="rgba(255,255,255,0.08)" />
                            ))}

                            {/* é–¾å€¤ç·š */}
                            <line x1={xScale(certThreshold)} y1={margin.top} x2={xScale(certThreshold)} y2={height - margin.bottom} stroke="rgba(255,255,255,0.35)" strokeWidth="2" strokeDasharray="8,4" />
                            <line x1={margin.left} y1={yScale(upsideThreshold)} x2={width - margin.right} y2={yScale(upsideThreshold)} stroke="rgba(255,255,255,0.35)" strokeWidth="2" strokeDasharray="8,4" />

                            {/* è»¸ãƒ©ãƒ™ãƒ« */}
                            <text x={width / 2} y={height - 10} fill="#9ca3af" fontSize="13" textAnchor="middle">ç¢ºå®Ÿæ€§ (Certainty) % â†’</text>
                            <text x={18} y={height / 2} fill="#9ca3af" fontSize="13" textAnchor="middle" transform={`rotate(-90, 18, ${height / 2})`}>ã‚¢ãƒƒãƒ—ã‚µã‚¤ãƒ‰ (Upside) % â†’</text>

                            {/* è»¸ç›®ç››ã‚Š */}
                            {[70, 75, 80, 85, 90, 95, 100].map(v => (
                                <text key={`xt${v}`} x={xScale(v)} y={height - margin.bottom + 18} fill="#6b7280" fontSize="11" textAnchor="middle">{v}</text>
                            ))}
                            {[30, 40, 50, 60, 70, 80].map(v => (
                                <text key={`yt${v}`} x={margin.left - 8} y={yScale(v) + 4} fill="#6b7280" fontSize="11" textAnchor="end">{v}</text>
                            ))}

                            {/* 15ä½ãƒ©ã‚¤ãƒ³ï¼ˆå‚è€ƒç·šï¼‰ */}
                            <line x1={margin.left} y1={margin.top} x2={margin.left} y2={height - margin.bottom} stroke="transparent" />

                            {sortedFilteredData.map((s) => {
                                const pos = positionMap[s.ticker];
                                const cx = pos.cx + pos.offsetX;
                                const cy = pos.cy + pos.offsetY;
                                const isHovered = hoveredStock?.ticker === s.ticker;
                                const isTop1 = s.rank === 1;
                                const isTop15 = s.rank <= 15;
                                const isHighMono = s.monopoly >= 26;
                                const r = isHovered ? baseRadius + 3 : baseRadius;

                                // 15ä½ä»¥ä¸‹ã¯å°‘ã—è–„ãè¡¨ç¤º
                                const opacity = isTop15 ? 0.95 : 0.6;

                                return (
                                    <g key={s.ticker}>
                                        {isHighMono && <circle cx={cx} cy={cy} r={r + 6} fill="none" stroke="#ef4444" strokeWidth="2" strokeDasharray="4,3" opacity={isTop15 ? 0.7 : 0.4} />}
                                        {isTop1 && <circle cx={cx} cy={cy} r={r + 10} fill="rgba(234, 179, 8, 0.35)" />}
                                        <circle
                                            cx={cx} cy={cy} r={r}
                                            fill={domainColors[s.domain]}
                                            fillOpacity={isHovered ? 1 : opacity}
                                            stroke={isTop1 ? "#fbbf24" : isHovered ? "#fff" : isTop15 ? "rgba(255,255,255,0.6)" : "rgba(255,255,255,0.3)"}
                                            strokeWidth={isTop1 ? 3 : isHovered ? 2.5 : isTop15 ? 1.5 : 1}
                                            style={{ cursor: "pointer", transition: "all 0.15s" }}
                                            onMouseEnter={() => setHoveredStock(s)}
                                            onMouseLeave={() => setHoveredStock(null)}
                                        />
                                        {/* ãƒ©ãƒ³ã‚¯ç•ªå·ã‚’è¡¨ç¤º */}
                                        <text
                                            x={cx} y={cy + 4}
                                            fill="#fff"
                                            fontSize={isTop15 ? "10" : "9"}
                                            textAnchor="middle"
                                            fontWeight="bold"
                                            style={{ pointerEvents: "none", textShadow: "0 1px 2px rgba(0,0,0,0.9)", opacity: isTop15 ? 1 : 0.7 }}
                                        >
                                            {s.rank}
                                        </text>
                                        {/* ãƒ›ãƒãƒ¼æ™‚ã«åå‰ã‚’ä¸Šã«è¡¨ç¤º */}
                                        {isHovered && (
                                            <text x={cx} y={cy - r - 6} fill="#fff" fontSize="12" textAnchor="middle" fontWeight="bold"
                                                style={{ textShadow: "0 1px 3px rgba(0,0,0,0.9)" }}>
                                                {s.name}
                                            </text>
                                        )}
                                    </g>
                                );
                            })}

                            {hoveredStock && (
                                <foreignObject
                                    x={Math.min(mousePos.x + 15, width - 265)}
                                    y={Math.max(10, Math.min(mousePos.y - 95, height - 200))}
                                    width="255" height="190"
                                >
                                    <div style={{
                                        background: "rgba(15, 23, 42, 0.97)",
                                        border: `2px solid ${domainColors[hoveredStock.domain]}`,
                                        borderRadius: "8px", padding: "12px", fontSize: "11px", color: "#e0e0e0",
                                        boxShadow: "0 4px 20px rgba(0,0,0,0.6)"
                                    }}>
                                        <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: "6px" }}>
                                            <b style={{ fontSize: "14px", color: "#fff" }}>
                                                <span style={{ color: hoveredStock.rank <= 15 ? "#22c55e" : "#9ca3af" }}>#{hoveredStock.rank}</span> {hoveredStock.name}
                                            </b>
                                            <span style={{ color: domainColors[hoveredStock.domain], fontSize: "11px" }}>{hoveredStock.domain}</span>
                                        </div>
                                        <div style={{ color: "#9ca3af", marginBottom: "8px", fontSize: "10px" }}>
                                            {hoveredStock.ticker} | {hoveredStock.core_tech}
                                        </div>
                                        <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: "4px", marginBottom: "8px", fontSize: "10px" }}>
                                            <div>ç‹¬å : <span style={{color: "#22c55e"}}>{hoveredStock.monopoly}/30</span></div>
                                            <div>è€æ€§: <span style={{color: "#3b82f6"}}>{hoveredStock.resilience}/20</span></div>
                                            <div>ã‚·ãƒŠã‚¸ãƒ¼: <span style={{color: "#a855f7"}}>{hoveredStock.synergy}/25</span></div>
                                            <div>éå¯¾ç§°: <span style={{color: "#f97316"}}>{hoveredStock.asymmetry}/15</span></div>
                                            <div>è³‡æœ¬åŠ¹ç‡: <span style={{color: "#ec4899"}}>{hoveredStock.capital}/10</span></div>
                                            <div><b>åˆè¨ˆ: <span style={{color: "#fbbf24"}}>{hoveredStock.total}/100</span></b></div>
                                        </div>
                                        <div style={{ display: "flex", gap: "12px", marginBottom: "6px", fontSize: "10px", color: "#9ca3af" }}>
                                            <span>ç¢ºå®Ÿæ€§: <b style={{color: "#fff"}}>{hoveredStock.certainty}%</b></span>
                                            <span>ã‚¢ãƒƒãƒ—ã‚µã‚¤ãƒ‰: <b style={{color: "#fff"}}>{hoveredStock.upside}%</b></span>
                                        </div>
                                        <div style={{ borderTop: "1px solid #374151", paddingTop: "6px", fontSize: "10px", color: "#9ca3af", lineHeight: 1.4 }}>
                                            {hoveredStock.thesis}
                                        </div>
                                        {hoveredStock.rank > 15 && (
                                            <div style={{ marginTop: "6px", padding: "4px 8px", background: "rgba(249, 115, 22, 0.2)", borderRadius: "4px", fontSize: "9px", color: "#f97316" }}>
                                                âš  16ä½ä»¥ä¸‹ï¼šæ”»ã‚ã®å§¿å‹¢æ™‚ã®ã¿æ¤œè¨
                                            </div>
                                        )}
                                    </div>
                                </foreignObject>
                            )}
                        </svg>
                    </div>

                    <div style={{ display: "flex", justifyContent: "center", gap: "20px", marginTop: "12px", fontSize: "12px", flexWrap: "wrap" }}>
                        <div style={{ display: "flex", alignItems: "center", gap: "16px" }}>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px" }}>
                                <span style={{ width: "12px", height: "12px", background: "#22c55e", borderRadius: "50%", opacity: 0.9 }}></span>
                                æœ€å„ªå…ˆ: {counts.prime}
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px" }}>
                                <span style={{ width: "12px", height: "12px", background: "#3b82f6", borderRadius: "50%", opacity: 0.9 }}></span>
                                å®‰å®š: {counts.stable}
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px" }}>
                                <span style={{ width: "12px", height: "12px", background: "#f97316", borderRadius: "50%", opacity: 0.9 }}></span>
                                æŠ•æ©Ÿçš„: {counts.spec}
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px" }}>
                                <span style={{ width: "12px", height: "12px", background: "#ef4444", borderRadius: "50%", opacity: 0.9 }}></span>
                                æ…é‡: {counts.avoid}
                            </span>
                        </div>
                        <span style={{ color: "#4b5563" }}>|</span>
                        <div style={{ display: "flex", alignItems: "center", gap: "12px" }}>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px", color: "#9ca3af" }}>
                                <span style={{ width: "14px", height: "14px", border: "2px dashed #ef4444", borderRadius: "50%" }}></span>
                                é«˜ç‹¬å  (â‰¥26)
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px", color: "#9ca3af" }}>
                                <span style={{ width: "14px", height: "14px", background: "rgba(234, 179, 8, 0.4)", borderRadius: "50%", border: "2.5px solid #fbbf24" }}></span>
                                #1
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px", color: "#6b7280" }}>
                                <span style={{ width: "12px", height: "12px", background: "#6b7280", borderRadius: "50%", opacity: 0.5 }}></span>
                                16ä½ä»¥ä¸‹ï¼ˆè–„è¡¨ç¤ºï¼‰
                            </span>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<QuadrantChart />);
    </script>
</body>
</html>
