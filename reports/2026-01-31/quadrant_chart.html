<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Japan Top 30 - 4象限マトリックス【2026-01-31】</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Arial, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #e0e0e0;
        }
        #root { width: 100%; min-height: 100vh; }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        /*
        Japan Top 30 4象限マトリックス テンプレート

        【プレースホルダー】
        - {{DATE}}: 分析日 (例: 2026-01-30)
        - {{MARKET_RISK_SCORE}}: 市場リスクスコア (例: 57)
        - {{STANCE}}: スタンス (例: バランス型)
        - {{JAPAN_TOP30_DATA}}: japan_top30配列をJSON形式で挿入

        【30社内相対評価の閾値】
        - 確実性閾値: 30社のcertainty中央値（動的計算）
        - アップサイド閾値: 30社のupside中央値（動的計算）

        【表示ルール】
        - バブルサイズ: baseRadius = 22px
        - 衝突回避: 上位ランク優先で右上にオフセット
        - 高構造的優位性銘柄(structural_advantage≥16): 赤い点線枠
        - #1銘柄: ゴールド背景
        - 16位以下: 薄く表示（攻め姿勢時のみ検討）
        */

        const analysisDate = "2026-01-31";
        const marketRiskScore = 57;
        const stance = "balanced";

        // top30.jsonのjapan_top30から生成（Phase 7で置換）
        const japanTop30Data = [
        {
            "rank": 1,
            "ticker": "7011.T",
            "name": "三菱重工業",
            "domain": "防衛",
            "core_tech": "防衛装備品（GCAP・イージス艦・ミサイル）、原子力プラント、H3ロケット",
            "total": 79,
            "structural_advantage": 18,
            "intrinsic_value": 14,
            "future_value": 22,
            "information_asymmetry": 12,
            "policy_catalyst": 13,
            "investment_factors": 32,
            "speculative_factors": 47,
            "certainty": 92,
            "upside": 45,
            "quadrant": "prime",
            "domains_impacted": ["防衛", "エネルギー", "宇宙", "ロボティクス", "AI", "サイバー"],
            "thesis": "国内唯一の総合防衛プライム。防衛受注残10兆円超、GCAP主契約者。原子力・H3ロケットで6ドメイン収束。時価総額15.7兆円。",
            "confidence_summary": "B"
        },
        {
            "rank": 2,
            "ticker": "8035.T",
            "name": "東京エレクトロン",
            "domain": "AI",
            "core_tech": "半導体製造装置（コータ/デベロッパ90%、エッチング30%+）",
            "total": 72,
            "structural_advantage": 17,
            "intrinsic_value": 15,
            "future_value": 20,
            "information_asymmetry": 8,
            "policy_catalyst": 12,
            "investment_factors": 32,
            "speculative_factors": 40,
            "certainty": 95,
            "upside": 35,
            "quadrant": "stable",
            "domains_impacted": ["AI", "ロボティクス"],
            "thesis": "コータ/デベロッパ世界90%独占。TSMC熊本4nm計画変更で追加装置需要（CHG-006）。AI半導体投資の構造的恩恵。",
            "confidence_summary": "A"
        },
        {
            "rank": 3,
            "ticker": "6954.T",
            "name": "ファナック",
            "domain": "ロボティクス",
            "core_tech": "CNC装置世界首位（50%+）、産業用ロボット、CRX-H1ヒューマノイド",
            "total": 71,
            "structural_advantage": 16,
            "intrinsic_value": 14,
            "future_value": 21,
            "information_asymmetry": 10,
            "policy_catalyst": 10,
            "investment_factors": 30,
            "speculative_factors": 41,
            "certainty": 95,
            "upside": 42,
            "quadrant": "prime",
            "domains_impacted": ["ロボティクス", "AI", "防衛"],
            "thesis": "CNC世界首位。Q3ロボット受注+38%、中国+87%回復。CRX-H1ヒューマノイド発表でNVIDIA共同開発（CHG-003）。OP guidance +10%上方修正。",
            "confidence_summary": "A"
        },
        {
            "rank": 4,
            "ticker": "6501.T",
            "name": "日立製作所",
            "domain": "エネルギー",
            "core_tech": "グリッド変圧器（40%）、HVDC、GE-Hitachi BWRX-300 SMR、Lumada DX",
            "total": 69,
            "structural_advantage": 15,
            "intrinsic_value": 14,
            "future_value": 19,
            "information_asymmetry": 9,
            "policy_catalyst": 12,
            "investment_factors": 29,
            "speculative_factors": 40,
            "certainty": 88,
            "upside": 38,
            "quadrant": "prime",
            "domains_impacted": ["エネルギー", "AI", "ロボティクス"],
            "thesis": "グリッド変圧器40%シェア。GE-Hitachi BWRX-300でSMR市場参入。時価総額20-24兆円（CHG-002修正済）。Lumada DXとデータセンター電力の交差点。",
            "confidence_summary": "B"
        },
        {
            "rank": 5,
            "ticker": "6315.T",
            "name": "TOWA",
            "domain": "AI",
            "core_tech": "HBMモールディング装置（世界66%シェア）、コンプレッションモールド技術",
            "total": 69,
            "structural_advantage": 16,
            "intrinsic_value": 11,
            "future_value": 18,
            "information_asymmetry": 16,
            "policy_catalyst": 8,
            "investment_factors": 27,
            "speculative_factors": 42,
            "certainty": 80,
            "upside": 75,
            "quadrant": "speculative",
            "domains_impacted": ["AI"],
            "thesis": "HBMモールド装置66%シェアで事実上の独占（CHG-009）。AI半導体後工程の隠れたボトルネック。外国人投資家にほぼ未認知。",
            "confidence_summary": "B"
        },
        {
            "rank": 6,
            "ticker": "6506.T",
            "name": "安川電機",
            "domain": "ロボティクス",
            "core_tech": "ACサーボモータ世界首位（20%）、産業用ロボット、MOTOMAN-HMヒューマノイド",
            "total": 68,
            "structural_advantage": 14,
            "intrinsic_value": 13,
            "future_value": 21,
            "information_asymmetry": 10,
            "policy_catalyst": 10,
            "investment_factors": 27,
            "speculative_factors": 41,
            "certainty": 88,
            "upside": 45,
            "quadrant": "prime",
            "domains_impacted": ["ロボティクス", "AI", "防衛"],
            "thesis": "ACサーボモータ世界首位。MOTOMAN-HMヒューマノイド開発進行、ソフトバンク提携（CHG-004）。インバータ大口受注。",
            "confidence_summary": "B"
        },
        {
            "rank": 7,
            "ticker": "9432.T",
            "name": "NTT",
            "domain": "AI",
            "core_tech": "国内データセンター（60%シェア）、IOWN光電融合、量子安全通信",
            "total": 67,
            "structural_advantage": 15,
            "intrinsic_value": 14,
            "future_value": 17,
            "information_asymmetry": 9,
            "policy_catalyst": 12,
            "investment_factors": 29,
            "speculative_factors": 38,
            "certainty": 90,
            "upside": 30,
            "quadrant": "stable",
            "domains_impacted": ["AI", "サイバー"],
            "thesis": "国内DC60%シェア。IOWN量子安全技術統合。AIデータセンター需要の国内最大の受け皿。安定配当。",
            "confidence_summary": "A"
        },
        {
            "rank": 8,
            "ticker": "6701.T",
            "name": "NEC",
            "domain": "サイバー",
            "core_tech": "サイバーセキュリティ、防衛通信システム、顔認証世界首位、海底ケーブル",
            "total": 66,
            "structural_advantage": 14,
            "intrinsic_value": 13,
            "future_value": 18,
            "information_asymmetry": 10,
            "policy_catalyst": 11,
            "investment_factors": 27,
            "speculative_factors": 39,
            "certainty": 88,
            "upside": 42,
            "quadrant": "prime",
            "domains_impacted": ["サイバー", "防衛", "AI", "宇宙"],
            "thesis": "政府向けサイバーセキュリティ国内首位級。KDDI-NEC協業。能動的サイバー防御の法整備で恩恵。",
            "confidence_summary": "B"
        },
        {
            "rank": 9,
            "ticker": "7012.T",
            "name": "川崎重工業",
            "domain": "防衛",
            "core_tech": "潜水艦建造（2社独占）、P-1哨戒機、水素液化プラント、ロボット",
            "total": 65,
            "structural_advantage": 15,
            "intrinsic_value": 11,
            "future_value": 19,
            "information_asymmetry": 9,
            "policy_catalyst": 11,
            "investment_factors": 26,
            "speculative_factors": 39,
            "certainty": 85,
            "upside": 42,
            "quadrant": "prime",
            "domains_impacted": ["防衛", "エネルギー", "ロボティクス", "宇宙"],
            "thesis": "防衛装備品契約2位。潜水艦建造で三菱重工と2社独占。日英伊次期戦闘機（GCAP）参画。水素液化プラントで脱炭素も。",
            "confidence_summary": "B"
        },
        {
            "rank": 10,
            "ticker": "7013.T",
            "name": "IHI",
            "domain": "エネルギー",
            "core_tech": "航空エンジン（国内唯一の量産メーカー）、NuScale SMRパートナー、ロケット",
            "total": 64,
            "structural_advantage": 15,
            "intrinsic_value": 10,
            "future_value": 19,
            "information_asymmetry": 10,
            "policy_catalyst": 10,
            "investment_factors": 25,
            "speculative_factors": 39,
            "certainty": 85,
            "upside": 48,
            "quadrant": "prime",
            "domains_impacted": ["エネルギー", "防衛", "宇宙"],
            "thesis": "航空エンジン国内唯一の量産メーカー。航空宇宙防衛受注残1.896兆円（+70%YoY）。NuScale SMRに$40M+投資。",
            "confidence_summary": "B"
        },
        {
            "rank": 11,
            "ticker": "6920.T",
            "name": "レーザーテック",
            "domain": "AI",
            "core_tech": "EUVマスク欠陥検査装置（世界100%独占）",
            "total": 63,
            "structural_advantage": 17,
            "intrinsic_value": 13,
            "future_value": 17,
            "information_asymmetry": 7,
            "policy_catalyst": 9,
            "investment_factors": 30,
            "speculative_factors": 33,
            "certainty": 92,
            "upside": 35,
            "quadrant": "stable",
            "domains_impacted": ["AI"],
            "thesis": "EUVマスク検査装置で世界100%独占。先端半導体製造に不可欠。無借金、営業利益率40%+。",
            "confidence_summary": "A"
        },
        {
            "rank": 12,
            "ticker": "186A.T",
            "name": "Astroscale HD",
            "domain": "宇宙",
            "core_tech": "軌道上サービス（デブリ除去、衛星延命）、RPO技術",
            "total": 63,
            "structural_advantage": 14,
            "intrinsic_value": 6,
            "future_value": 18,
            "information_asymmetry": 15,
            "policy_catalyst": 10,
            "investment_factors": 20,
            "speculative_factors": 43,
            "certainty": 70,
            "upside": 85,
            "quadrant": "speculative",
            "domains_impacted": ["宇宙", "防衛"],
            "thesis": "軌道上サービス世界リーダー。デブリ除去で唯一の商用実績。宇宙安全保障・アルテミス参画期待。",
            "confidence_summary": "C"
        },
        {
            "rank": 13,
            "ticker": "6503.T",
            "name": "三菱電機",
            "domain": "防衛",
            "core_tech": "防衛エレクトロニクス（レーダー・ミサイル誘導）、FA機器、パワー半導体、衛星",
            "total": 62,
            "structural_advantage": 14,
            "intrinsic_value": 13,
            "future_value": 18,
            "information_asymmetry": 8,
            "policy_catalyst": 9,
            "investment_factors": 27,
            "speculative_factors": 35,
            "certainty": 85,
            "upside": 38,
            "quadrant": "stable",
            "domains_impacted": ["防衛", "ロボティクス", "エネルギー", "宇宙"],
            "thesis": "防衛エレクトロニクス国内首位。レーダー・誘導装置。FA機器2位でロボティクス需要も。パワー半導体成長。",
            "confidence_summary": "B"
        },
        {
            "rank": 14,
            "ticker": "6146.T",
            "name": "ディスコ",
            "domain": "AI",
            "core_tech": "ダイシングソー（80%）、グラインダ（70%+）、半導体後工程独占",
            "total": 62,
            "structural_advantage": 16,
            "intrinsic_value": 14,
            "future_value": 17,
            "information_asymmetry": 7,
            "policy_catalyst": 8,
            "investment_factors": 30,
            "speculative_factors": 32,
            "certainty": 90,
            "upside": 35,
            "quadrant": "stable",
            "domains_impacted": ["AI"],
            "thesis": "半導体切断・研磨装置で世界80%独占。消耗品モデルで安定収益。先端パッケージング需要増。無借金。",
            "confidence_summary": "A"
        },
        {
            "rank": 15,
            "ticker": "6857.T",
            "name": "アドバンテスト",
            "domain": "AI",
            "core_tech": "半導体テスタ（メモリ50%+、SoC 30%+）、HBMテスト",
            "total": 61,
            "structural_advantage": 15,
            "intrinsic_value": 13,
            "future_value": 17,
            "information_asymmetry": 8,
            "policy_catalyst": 8,
            "investment_factors": 28,
            "speculative_factors": 33,
            "certainty": 88,
            "upside": 35,
            "quadrant": "stable",
            "domains_impacted": ["AI"],
            "thesis": "半導体テスト装置で世界2位。AI半導体の複雑化でテスト需要構造的増加。HBMテスト需要。実質無借金。",
            "confidence_summary": "A"
        },
        {
            "rank": 16,
            "ticker": "6758.T",
            "name": "ソニーグループ",
            "domain": "AI",
            "core_tech": "CMOSイメージセンサー世界首位（50%+）、ゲーム、エンタテインメント",
            "total": 60,
            "structural_advantage": 15,
            "intrinsic_value": 13,
            "future_value": 16,
            "information_asymmetry": 7,
            "policy_catalyst": 9,
            "investment_factors": 28,
            "speculative_factors": 32,
            "certainty": 85,
            "upside": 35,
            "quadrant": "stable",
            "domains_impacted": ["AI", "ロボティクス"],
            "thesis": "イメージセンサー世界首位50%シェア。自動運転・ロボットビジョン向け需要。エンタテインメント多角化。",
            "confidence_summary": "B"
        },
        {
            "rank": 17,
            "ticker": "5631.T",
            "name": "日本製鋼所",
            "domain": "エネルギー",
            "core_tech": "原子力圧力容器（世界80%+）、防衛砲身（国内独占）、14,000tプレス",
            "total": 60,
            "structural_advantage": 16,
            "intrinsic_value": 10,
            "future_value": 16,
            "information_asymmetry": 10,
            "policy_catalyst": 8,
            "investment_factors": 26,
            "speculative_factors": 34,
            "certainty": 82,
            "upside": 50,
            "quadrant": "prime",
            "domains_impacted": ["エネルギー", "防衛"],
            "thesis": "原子力圧力容器で世界80%+独占。14,000tプレスは世界数台のみ。防衛向け戦車砲身も国内独占。",
            "confidence_summary": "B"
        },
        {
            "rank": 18,
            "ticker": "6861.T",
            "name": "キーエンス",
            "domain": "ロボティクス",
            "core_tech": "FAセンサー国内首位、画像処理、計測機器、営業利益率55%",
            "total": 59,
            "structural_advantage": 14,
            "intrinsic_value": 15,
            "future_value": 16,
            "information_asymmetry": 6,
            "policy_catalyst": 8,
            "investment_factors": 29,
            "speculative_factors": 30,
            "certainty": 90,
            "upside": 25,
            "quadrant": "stable",
            "domains_impacted": ["ロボティクス", "AI"],
            "thesis": "FAセンサー国内首位。営業利益率55%の超高収益体質。直販モデルで顧客密着。無借金・自己資本比率95%。",
            "confidence_summary": "A"
        },
        {
            "rank": 19,
            "ticker": "6723.T",
            "name": "ルネサスエレクトロニクス",
            "domain": "AI",
            "core_tech": "車載MCU世界3位、パワー半導体、アナログ半導体",
            "total": 59,
            "structural_advantage": 13,
            "intrinsic_value": 12,
            "future_value": 17,
            "information_asymmetry": 9,
            "policy_catalyst": 8,
            "investment_factors": 25,
            "speculative_factors": 34,
            "certainty": 82,
            "upside": 42,
            "quadrant": "prime",
            "domains_impacted": ["AI", "ロボティクス"],
            "thesis": "車載半導体世界3位。自動運転・EV向けMCU/パワー半導体で需要拡大。M&Aで製品ライン拡充。",
            "confidence_summary": "B"
        },
        {
            "rank": 20,
            "ticker": "7735.T",
            "name": "SCREEN HD",
            "domain": "AI",
            "core_tech": "半導体洗浄装置世界首位（60%シェア）",
            "total": 58,
            "structural_advantage": 15,
            "intrinsic_value": 12,
            "future_value": 16,
            "information_asymmetry": 7,
            "policy_catalyst": 8,
            "investment_factors": 27,
            "speculative_factors": 31,
            "certainty": 85,
            "upside": 35,
            "quadrant": "stable",
            "domains_impacted": ["AI"],
            "thesis": "半導体洗浄装置世界首位60%シェア。先端プロセスで洗浄回数増加、構造的需要成長。",
            "confidence_summary": "B"
        },
        {
            "rank": 21,
            "ticker": "6268.T",
            "name": "ナブテスコ",
            "domain": "ロボティクス",
            "core_tech": "RV精密減速機世界首位（60%シェア）、航空機器",
            "total": 57,
            "structural_advantage": 15,
            "intrinsic_value": 11,
            "future_value": 16,
            "information_asymmetry": 8,
            "policy_catalyst": 7,
            "investment_factors": 26,
            "speculative_factors": 31,
            "certainty": 82,
            "upside": 38,
            "quadrant": "stable",
            "domains_impacted": ["ロボティクス", "防衛"],
            "thesis": "RV精密減速機世界60%シェア。産業用ロボットの心臓部（CHG-010）。ヒューマノイド向け新規需要期待。",
            "confidence_summary": "B"
        },
        {
            "rank": 22,
            "ticker": "6273.T",
            "name": "SMC",
            "domain": "ロボティクス",
            "core_tech": "空圧機器世界首位（40%シェア）、真空機器",
            "total": 57,
            "structural_advantage": 14,
            "intrinsic_value": 14,
            "future_value": 15,
            "information_asymmetry": 6,
            "policy_catalyst": 8,
            "investment_factors": 28,
            "speculative_factors": 29,
            "certainty": 85,
            "upside": 30,
            "quadrant": "stable",
            "domains_impacted": ["ロボティクス", "AI"],
            "thesis": "空圧機器世界首位40%。80万種の製品ライン。半導体製造装置・ロボット向け。無借金・キャッシュリッチ。",
            "confidence_summary": "A"
        },
        {
            "rank": 23,
            "ticker": "9501.T",
            "name": "東京電力HD",
            "domain": "エネルギー",
            "core_tech": "柏崎刈羽原発（821万kW）、送配電インフラ",
            "total": 56,
            "structural_advantage": 13,
            "intrinsic_value": 8,
            "future_value": 15,
            "information_asymmetry": 11,
            "policy_catalyst": 9,
            "investment_factors": 21,
            "speculative_factors": 35,
            "certainty": 65,
            "upside": 65,
            "quadrant": "speculative",
            "domains_impacted": ["エネルギー"],
            "thesis": "柏崎刈羽（821万kW）再稼働で収益劇的改善期待。しかし制御棒設定ミス判明で停止中（CHG-007）。時期不透明。",
            "confidence_summary": "C"
        },
        {
            "rank": 24,
            "ticker": "6324.T",
            "name": "ハーモニック・ドライブ・システムズ",
            "domain": "ロボティクス",
            "core_tech": "波動歯車減速機世界独占（80%+シェア）",
            "total": 56,
            "structural_advantage": 15,
            "intrinsic_value": 9,
            "future_value": 16,
            "information_asymmetry": 9,
            "policy_catalyst": 7,
            "investment_factors": 24,
            "speculative_factors": 32,
            "certainty": 75,
            "upside": 55,
            "quadrant": "speculative",
            "domains_impacted": ["ロボティクス", "宇宙"],
            "thesis": "波動歯車減速機80%+世界独占。ヒューマノイドロボット関節の必需品。小型・高精度で代替困難。",
            "confidence_summary": "C"
        },
        {
            "rank": 25,
            "ticker": "6702.T",
            "name": "富士通",
            "domain": "サイバー",
            "core_tech": "政府向けITシステム、量子コンピュータ、サイバーセキュリティ",
            "total": 55,
            "structural_advantage": 12,
            "intrinsic_value": 12,
            "future_value": 15,
            "information_asymmetry": 8,
            "policy_catalyst": 8,
            "investment_factors": 24,
            "speculative_factors": 31,
            "certainty": 80,
            "upside": 35,
            "quadrant": "stable",
            "domains_impacted": ["サイバー", "AI"],
            "thesis": "政府・防衛向けITシステム大手。量子コンピュータ研究で国内先行。経済安保法対応需要。",
            "confidence_summary": "B"
        },
        {
            "rank": 26,
            "ticker": "9348.T",
            "name": "ispace",
            "domain": "宇宙",
            "core_tech": "月面着陸機、月面探査、CLPS（NASA商用月面輸送プログラム）",
            "total": 55,
            "structural_advantage": 13,
            "intrinsic_value": 5,
            "future_value": 16,
            "information_asymmetry": 13,
            "policy_catalyst": 8,
            "investment_factors": 18,
            "speculative_factors": 37,
            "certainty": 60,
            "upside": 90,
            "quadrant": "speculative",
            "domains_impacted": ["宇宙"],
            "thesis": "民間月面探査で世界先行。Mission 2成功実績。NASA CLPSプログラム参画。アルテミス計画の民間パートナー。",
            "confidence_summary": "C"
        },
        {
            "rank": 27,
            "ticker": "1963.T",
            "name": "日揮HD",
            "domain": "エネルギー",
            "core_tech": "LNGプラント建設世界大手、水素・アンモニアプラント",
            "total": 54,
            "structural_advantage": 12,
            "intrinsic_value": 11,
            "future_value": 15,
            "information_asymmetry": 8,
            "policy_catalyst": 8,
            "investment_factors": 23,
            "speculative_factors": 31,
            "certainty": 78,
            "upside": 40,
            "quadrant": "prime",
            "domains_impacted": ["エネルギー"],
            "thesis": "LNGプラント世界大手。GX推進法で水素・アンモニアプラント需要拡大。GX経済移行債20兆円の恩恵。",
            "confidence_summary": "B"
        },
        {
            "rank": 28,
            "ticker": "6481.T",
            "name": "THK",
            "domain": "ロボティクス",
            "core_tech": "LMガイド世界首位（50%）、ボールねじ",
            "total": 54,
            "structural_advantage": 14,
            "intrinsic_value": 11,
            "future_value": 15,
            "information_asymmetry": 7,
            "policy_catalyst": 7,
            "investment_factors": 25,
            "speculative_factors": 29,
            "certainty": 80,
            "upside": 35,
            "quadrant": "stable",
            "domains_impacted": ["ロボティクス", "AI"],
            "thesis": "LMガイド世界首位50%シェア。直動案内の発明者。ロボット・半導体装置・工作機械の精密動作に不可欠。",
            "confidence_summary": "B"
        },
        {
            "rank": 29,
            "ticker": "4704.T",
            "name": "トレンドマイクロ",
            "domain": "サイバー",
            "core_tech": "エンドポイントセキュリティ世界トップ3、Vision One XDR",
            "total": 53,
            "structural_advantage": 12,
            "intrinsic_value": 12,
            "future_value": 14,
            "information_asymmetry": 7,
            "policy_catalyst": 8,
            "investment_factors": 24,
            "speculative_factors": 29,
            "certainty": 78,
            "upside": 32,
            "quadrant": "stable",
            "domains_impacted": ["サイバー"],
            "thesis": "サイバーセキュリティ世界トップ3。Vision One XDRで企業向け統合セキュリティ。経済安保法対応需要。",
            "confidence_summary": "B"
        },
        {
            "rank": 30,
            "ticker": "9503.T",
            "name": "関西電力",
            "domain": "エネルギー",
            "core_tech": "原子力発電（7基稼働、国内最高稼働率）、送配電",
            "total": 52,
            "structural_advantage": 13,
            "intrinsic_value": 11,
            "future_value": 13,
            "information_asymmetry": 7,
            "policy_catalyst": 8,
            "investment_factors": 24,
            "speculative_factors": 28,
            "certainty": 80,
            "upside": 30,
            "quadrant": "stable",
            "domains_impacted": ["エネルギー"],
            "thesis": "原子力稼働率国内最高。7基稼働で収益安定。原発推進政策の恩恵。安定配当。",
            "confidence_summary": "B"
        }
];

        const domainColors = {
            "AI": "#a855f7", "防衛": "#3b82f6", "エネルギー": "#22c55e",
            "ロボティクス": "#f97316", "宇宙": "#06b6d4", "サイバー": "#ec4899", "半導体": "#eab308"
        };

        // 中央値計算（30社相対評価用）
        function calculateMedian(arr) {
            const sorted = [...arr].sort((a, b) => a - b);
            const mid = Math.floor(sorted.length / 2);
            return sorted.length % 2 !== 0 ? sorted[mid] : (sorted[mid - 1] + sorted[mid]) / 2;
        }

        // 衝突回避: 重なりを検出し、上位（ランク小さい方）を右上にオフセット
        function resolveCollisions(data, xScale, yScale, baseRadius) {
            const positions = data.map(s => ({
                ...s,
                cx: xScale(s.certainty),
                cy: yScale(s.upside),
                offsetX: 0,
                offsetY: 0
            }));

            positions.sort((a, b) => a.rank - b.rank);
            const minDistance = baseRadius * 2.3;

            for (let i = 0; i < positions.length; i++) {
                for (let j = 0; j < i; j++) {
                    const dx = (positions[i].cx + positions[i].offsetX) - (positions[j].cx + positions[j].offsetX);
                    const dy = (positions[i].cy + positions[i].offsetY) - (positions[j].cy + positions[j].offsetY);
                    const distance = Math.sqrt(dx * dx + dy * dy);

                    if (distance < minDistance) {
                        const overlap = minDistance - distance;
                        positions[j].offsetX += overlap * 0.6 + 4;
                        positions[j].offsetY -= overlap * 0.5 + 3;
                    }
                }
            }

            return positions;
        }

        function QuadrantChart() {
            const [selectedStock, setSelectedStock] = React.useState(null);
            const [hoveredStock, setHoveredStock] = React.useState(null);
            const [selectedDomain, setSelectedDomain] = React.useState("all");

            const width = 1100;
            const height = 750;
            const margin = { top: 50, right: 40, bottom: 50, left: 55 };
            const chartWidth = width - margin.left - margin.right;
            const chartHeight = height - margin.top - margin.bottom;

            // 30社のデータ範囲に基づくスケール（動的計算）
            const certValues = japanTop30Data.map(s => s.certainty);
            const upsideValues = japanTop30Data.map(s => s.upside);
            const xMin = Math.floor(Math.min(...certValues) - 2);
            const xMax = Math.ceil(Math.max(...certValues) + 2);
            const yMin = Math.floor(Math.min(...upsideValues) - 5);
            const yMax = Math.ceil(Math.max(...upsideValues) + 5);

            const xScale = (c) => margin.left + ((c - xMin) / (xMax - xMin)) * chartWidth;
            const yScale = (u) => margin.top + chartHeight - ((u - yMin) / (yMax - yMin)) * chartHeight;

            // 閾値: 30社の中央値（相対評価）
            const certThreshold = Math.round(calculateMedian(certValues));
            const upsideThreshold = Math.round(calculateMedian(upsideValues));
            const baseRadius = 22;

            const filteredData = selectedDomain === "all" ? japanTop30Data : japanTop30Data.filter(s => s.domain === selectedDomain);

            const allPositions = resolveCollisions(japanTop30Data, xScale, yScale, baseRadius);
            const positionMap = {};
            allPositions.forEach(p => { positionMap[p.ticker] = p; });

            const domains = [...new Set(japanTop30Data.map(s => s.domain))];

            const quadrantBgs = [
                { x: xScale(certThreshold), y: margin.top, w: xScale(xMax) - xScale(certThreshold), h: yScale(upsideThreshold) - margin.top, color: "rgba(34, 197, 94, 0.15)", label: "最優先", sublabel: "高確実×高アップサイド" },
                { x: margin.left, y: margin.top, w: xScale(certThreshold) - margin.left, h: yScale(upsideThreshold) - margin.top, color: "rgba(249, 115, 22, 0.12)", label: "投機的", sublabel: "低確実×高アップサイド" },
                { x: xScale(certThreshold), y: yScale(upsideThreshold), w: xScale(xMax) - xScale(certThreshold), h: yScale(yMin) - yScale(upsideThreshold), color: "rgba(59, 130, 246, 0.12)", label: "安定", sublabel: "高確実×低アップサイド" },
                { x: margin.left, y: yScale(upsideThreshold), w: xScale(certThreshold) - margin.left, h: yScale(yMin) - yScale(upsideThreshold), color: "rgba(239, 68, 68, 0.08)", label: "慎重", sublabel: "低確実×低アップサイド" }
            ];

            const counts = {
                prime: japanTop30Data.filter(s => s.certainty >= certThreshold && s.upside >= upsideThreshold).length,
                stable: japanTop30Data.filter(s => s.certainty >= certThreshold && s.upside < upsideThreshold).length,
                spec: japanTop30Data.filter(s => s.certainty < certThreshold && s.upside >= upsideThreshold).length,
                avoid: japanTop30Data.filter(s => s.certainty < certThreshold && s.upside < upsideThreshold).length
            };

            const sortedFilteredData = [...filteredData].sort((a, b) => b.rank - a.rank);

            const displayStock = selectedStock || hoveredStock;

            // 市場リスクに応じた色
            const riskColor = marketRiskScore >= 70 ? "#ef4444" : marketRiskScore >= 50 ? "#eab308" : "#22c55e";

            return (
                <div style={{ padding: "16px", maxWidth: "1500px", margin: "0 auto" }}>
                    <div style={{ textAlign: "center", marginBottom: "12px" }}>
                        <h1 style={{ fontSize: "24px", fontWeight: "bold", color: "#fff", marginBottom: "4px" }}>
                            Japan Top 30 - 4象限マトリックス
                        </h1>
                        <div style={{ display: "flex", justifyContent: "center", gap: "24px", fontSize: "13px", color: "#9ca3af" }}>
                            <span>市場リスク: <b style={{color: riskColor}}>{marketRiskScore}/100</b></span>
                            <span>スタンス: {stance}</span>
                            <span>更新: {analysisDate}</span>
                        </div>
                        <div style={{ fontSize: "11px", color: "#6b7280", marginTop: "4px" }}>
                            ※ 軸は30社内での相対位置 | 閾値: 確実性{certThreshold}% / アップサイド{upsideThreshold}%（中央値基準）| クリックで詳細固定
                        </div>
                    </div>

                    <div style={{ display: "flex", flexWrap: "wrap", gap: "6px", marginBottom: "12px", justifyContent: "center" }}>
                        <button onClick={() => setSelectedDomain("all")} style={{
                            padding: "4px 12px", borderRadius: "16px", fontSize: "12px", cursor: "pointer",
                            border: selectedDomain === "all" ? "2px solid #fff" : "1px solid #4b5563",
                            background: selectedDomain === "all" ? "rgba(255,255,255,0.1)" : "transparent", color: "#fff"
                        }}>全て ({japanTop30Data.length})</button>
                        {domains.map(d => (
                            <button key={d} onClick={() => setSelectedDomain(d)} style={{
                                padding: "4px 12px", borderRadius: "16px", fontSize: "12px", cursor: "pointer",
                                border: selectedDomain === d ? `2px solid ${domainColors[d]}` : "1px solid #4b5563",
                                background: selectedDomain === d ? `${domainColors[d]}30` : "transparent", color: domainColors[d]
                            }}>{d} ({japanTop30Data.filter(s => s.domain === d).length})</button>
                        ))}
                    </div>

                    <div style={{ display: "flex", gap: "16px" }}>
                        {/* チャート部分 */}
                        <div style={{ background: "rgba(30, 41, 59, 0.4)", borderRadius: "12px", padding: "12px", border: "1px solid rgba(255,255,255,0.1)", flex: "1" }}>
                            <svg width={width} height={height} style={{ display: "block", margin: "0 auto" }}
                                onClick={(e) => {
                                    if (e.target.tagName === 'svg' || e.target.tagName === 'rect' || e.target.tagName === 'line') {
                                        setSelectedStock(null);
                                    }
                                }}>

                                {quadrantBgs.map((q, i) => (
                                    <g key={i}>
                                        <rect x={q.x} y={q.y} width={q.w} height={q.h} fill={q.color} />
                                        <text x={q.x + q.w/2} y={q.y + 26} fill="rgba(255,255,255,0.4)" fontSize="18" textAnchor="middle" fontWeight="bold">{q.label}</text>
                                        <text x={q.x + q.w/2} y={q.y + 46} fill="rgba(255,255,255,0.25)" fontSize="11" textAnchor="middle">{q.sublabel}</text>
                                    </g>
                                ))}

                                {/* グリッド線（動的） */}
                                {Array.from({length: 7}, (_, i) => Math.round(xMin + (xMax - xMin) * i / 6)).map(v => (
                                    <line key={`xg${v}`} x1={xScale(v)} y1={margin.top} x2={xScale(v)} y2={height - margin.bottom} stroke="rgba(255,255,255,0.08)" />
                                ))}
                                {Array.from({length: 7}, (_, i) => Math.round(yMin + (yMax - yMin) * i / 6)).map(v => (
                                    <line key={`yg${v}`} x1={margin.left} y1={yScale(v)} x2={width - margin.right} y2={yScale(v)} stroke="rgba(255,255,255,0.08)" />
                                ))}

                                <line x1={xScale(certThreshold)} y1={margin.top} x2={xScale(certThreshold)} y2={height - margin.bottom} stroke="rgba(255,255,255,0.4)" strokeWidth="2" strokeDasharray="8,4" />
                                <line x1={margin.left} y1={yScale(upsideThreshold)} x2={width - margin.right} y2={yScale(upsideThreshold)} stroke="rgba(255,255,255,0.4)" strokeWidth="2" strokeDasharray="8,4" />

                                <text x={width / 2} y={height - 10} fill="#9ca3af" fontSize="13" textAnchor="middle">確実性 (Certainty) % →</text>
                                <text x={18} y={height / 2} fill="#9ca3af" fontSize="13" textAnchor="middle" transform={`rotate(-90, 18, ${height / 2})`}>アップサイド (Upside) % →</text>

                                {/* X軸ラベル（動的） */}
                                {Array.from({length: 7}, (_, i) => Math.round(xMin + (xMax - xMin) * i / 6)).map(v => (
                                    <text key={`xt${v}`} x={xScale(v)} y={height - margin.bottom + 18} fill="#6b7280" fontSize="11" textAnchor="middle">{v}</text>
                                ))}
                                {/* Y軸ラベル（動的） */}
                                {Array.from({length: 7}, (_, i) => Math.round(yMin + (yMax - yMin) * i / 6)).map(v => (
                                    <text key={`yt${v}`} x={margin.left - 8} y={yScale(v) + 4} fill="#6b7280" fontSize="11" textAnchor="end">{v}</text>
                                ))}

                                {sortedFilteredData.map((s) => {
                                    const pos = positionMap[s.ticker];
                                    const cx = pos.cx + pos.offsetX;
                                    const cy = pos.cy + pos.offsetY;
                                    const isSelected = selectedStock?.ticker === s.ticker;
                                    const isHovered = hoveredStock?.ticker === s.ticker;
                                    const isActive = isSelected || isHovered;
                                    const isTop1 = s.rank === 1;
                                    const isTop15 = s.rank <= 15;
                                    const isHighMono = s.structural_advantage >= 16;
                                    const r = isActive ? baseRadius + 4 : baseRadius;

                                    const opacity = isTop15 ? 0.95 : 0.65;

                                    return (
                                        <g key={s.ticker}
                                            style={{ cursor: "pointer" }}
                                            onClick={(e) => {
                                                e.stopPropagation();
                                                setSelectedStock(isSelected ? null : s);
                                            }}
                                            onMouseEnter={() => setHoveredStock(s)}
                                            onMouseLeave={() => setHoveredStock(null)}>
                                            {isHighMono && <circle cx={cx} cy={cy} r={r + 8} fill="none" stroke="#ef4444" strokeWidth="2.5" strokeDasharray="5,3" opacity={isTop15 ? 0.8 : 0.5} />}
                                            {isTop1 && <circle cx={cx} cy={cy} r={r + 12} fill="rgba(234, 179, 8, 0.4)" />}
                                            <circle
                                                cx={cx} cy={cy} r={r}
                                                fill={domainColors[s.domain]}
                                                fillOpacity={isActive ? 1 : opacity}
                                                stroke={isSelected ? "#fff" : isTop1 ? "#fbbf24" : isHovered ? "#fff" : isTop15 ? "rgba(255,255,255,0.6)" : "rgba(255,255,255,0.35)"}
                                                strokeWidth={isSelected ? 4 : isTop1 ? 3.5 : isHovered ? 3 : isTop15 ? 2 : 1.5}
                                                style={{ transition: "all 0.15s" }}
                                            />
                                            <text
                                                x={cx} y={cy + 5}
                                                fill="#fff"
                                                fontSize={isTop15 ? "13" : "11"}
                                                textAnchor="middle"
                                                fontWeight="bold"
                                                style={{ pointerEvents: "none", textShadow: "0 1px 3px rgba(0,0,0,0.9)" }}
                                            >
                                                {s.rank}
                                            </text>
                                            {isActive && (
                                                <text x={cx} y={cy - r - 8} fill="#fff" fontSize="13" textAnchor="middle" fontWeight="bold"
                                                    style={{ pointerEvents: "none", textShadow: "0 2px 4px rgba(0,0,0,0.9)" }}>
                                                    {s.name}
                                                </text>
                                            )}
                                        </g>
                                    );
                                })}
                            </svg>
                        </div>

                        {/* 右側の詳細パネル */}
                        <div style={{ width: "280px", flexShrink: 0 }}>
                            {displayStock ? (
                                <div style={{
                                    background: "rgba(15, 23, 42, 0.97)",
                                    border: `3px solid ${domainColors[displayStock.domain]}`,
                                    borderRadius: "12px",
                                    padding: "16px",
                                    boxShadow: "0 4px 20px rgba(0,0,0,0.5)"
                                }}>
                                    <div style={{ display: "flex", justifyContent: "space-between", alignItems: "center", marginBottom: "10px" }}>
                                        <div>
                                            <span style={{
                                                fontSize: "24px",
                                                fontWeight: "bold",
                                                color: displayStock.rank <= 15 ? "#22c55e" : "#9ca3af"
                                            }}>#{displayStock.rank}</span>
                                            <span style={{ fontSize: "18px", fontWeight: "bold", color: "#fff", marginLeft: "8px" }}>{displayStock.name}</span>
                                        </div>
                                        {selectedStock && (
                                            <button onClick={() => setSelectedStock(null)} style={{
                                                background: "rgba(255,255,255,0.1)",
                                                border: "none",
                                                borderRadius: "50%",
                                                width: "24px",
                                                height: "24px",
                                                color: "#9ca3af",
                                                cursor: "pointer",
                                                fontSize: "14px"
                                            }}>✕</button>
                                        )}
                                    </div>
                                    <div style={{
                                        display: "inline-block",
                                        padding: "3px 10px",
                                        background: `${domainColors[displayStock.domain]}30`,
                                        borderRadius: "12px",
                                        color: domainColors[displayStock.domain],
                                        fontSize: "12px",
                                        marginBottom: "10px"
                                    }}>{displayStock.domain}</div>
                                    <div style={{ color: "#9ca3af", marginBottom: "12px", fontSize: "12px" }}>
                                        {displayStock.ticker} | {displayStock.core_tech}
                                    </div>

                                    {/* 投資的要因 / 投機的要因 */}
                                    <div style={{ display: "flex", gap: "6px", marginBottom: "8px" }}>
                                        <div style={{ flex: "1", background: "rgba(59, 130, 246, 0.15)", padding: "6px", borderRadius: "6px", textAlign: "center" }}>
                                            <div style={{ fontSize: "9px", color: "#93c5fd" }}>投資的要因(B)</div>
                                            <div style={{ fontSize: "18px", fontWeight: "bold", color: "#3b82f6" }}>{displayStock.investment_factors}/40</div>
                                        </div>
                                        <div style={{ flex: "1", background: "rgba(168, 85, 247, 0.15)", padding: "6px", borderRadius: "6px", textAlign: "center" }}>
                                            <div style={{ fontSize: "9px", color: "#c4b5fd" }}>投機的要因(A)</div>
                                            <div style={{ fontSize: "18px", fontWeight: "bold", color: "#a855f7" }}>{displayStock.speculative_factors}/60</div>
                                        </div>
                                        <div style={{ flex: "1", background: "rgba(234, 179, 8, 0.15)", padding: "6px", borderRadius: "6px", textAlign: "center" }}>
                                            <div style={{ fontSize: "9px", color: "#fde68a" }}>合計</div>
                                            <div style={{ fontSize: "18px", fontWeight: "bold", color: "#fbbf24" }}>{displayStock.total}/100</div>
                                        </div>
                                    </div>

                                    <div style={{ display: "grid", gridTemplateColumns: "1fr 1fr", gap: "6px", marginBottom: "10px" }}>
                                        <div style={{ background: "rgba(34, 197, 94, 0.1)", padding: "6px", borderRadius: "6px" }}>
                                            <div style={{ fontSize: "9px", color: "#9ca3af" }}>構造的優位性</div>
                                            <div style={{ fontSize: "14px", fontWeight: "bold", color: "#22c55e" }}>{displayStock.structural_advantage}/20</div>
                                        </div>
                                        <div style={{ background: "rgba(59, 130, 246, 0.1)", padding: "6px", borderRadius: "6px" }}>
                                            <div style={{ fontSize: "9px", color: "#9ca3af" }}>本質的価値</div>
                                            <div style={{ fontSize: "14px", fontWeight: "bold", color: "#3b82f6" }}>{displayStock.intrinsic_value}/20</div>
                                        </div>
                                        <div style={{ background: "rgba(168, 85, 247, 0.1)", padding: "6px", borderRadius: "6px" }}>
                                            <div style={{ fontSize: "9px", color: "#9ca3af" }}>将来の価値</div>
                                            <div style={{ fontSize: "14px", fontWeight: "bold", color: "#a855f7" }}>{displayStock.future_value}/25</div>
                                        </div>
                                        <div style={{ background: "rgba(249, 115, 22, 0.1)", padding: "6px", borderRadius: "6px" }}>
                                            <div style={{ fontSize: "9px", color: "#9ca3af" }}>情報非対称性</div>
                                            <div style={{ fontSize: "14px", fontWeight: "bold", color: "#f97316" }}>{displayStock.information_asymmetry}/20</div>
                                        </div>
                                        <div style={{ gridColumn: "1 / -1", background: "rgba(236, 72, 153, 0.1)", padding: "6px", borderRadius: "6px" }}>
                                            <div style={{ fontSize: "9px", color: "#9ca3af" }}>政策・触媒</div>
                                            <div style={{ fontSize: "14px", fontWeight: "bold", color: "#ec4899" }}>{displayStock.policy_catalyst}/15</div>
                                        </div>
                                    </div>

                                    {/* 確度表示 */}
                                    {displayStock.confidence_summary && (
                                        <div style={{ fontSize: "11px", color: "#9ca3af", marginBottom: "8px", padding: "6px", background: "rgba(255,255,255,0.03)", borderRadius: "4px" }}>
                                            確度: {displayStock.confidence_summary}
                                        </div>
                                    )}

                                    <div style={{ display: "flex", gap: "16px", marginBottom: "12px", padding: "10px", background: "rgba(255,255,255,0.05)", borderRadius: "6px" }}>
                                        <div>
                                            <div style={{ fontSize: "10px", color: "#9ca3af" }}>確実性</div>
                                            <div style={{ fontSize: "18px", fontWeight: "bold", color: "#fff" }}>{displayStock.certainty}%</div>
                                        </div>
                                        <div>
                                            <div style={{ fontSize: "10px", color: "#9ca3af" }}>アップサイド</div>
                                            <div style={{ fontSize: "18px", fontWeight: "bold", color: "#fff" }}>{displayStock.upside}%</div>
                                        </div>
                                    </div>

                                    <div style={{ fontSize: "12px", color: "#d1d5db", lineHeight: 1.5, borderTop: "1px solid #374151", paddingTop: "12px" }}>
                                        {displayStock.thesis}
                                    </div>

                                    {displayStock.rank > 15 && (
                                        <div style={{ marginTop: "12px", padding: "8px 12px", background: "rgba(249, 115, 22, 0.2)", borderRadius: "6px", fontSize: "11px", color: "#f97316" }}>
                                            ⚠ 16位以下：攻めの姿勢時のみ検討
                                        </div>
                                    )}
                                </div>
                            ) : (
                                <div style={{
                                    background: "rgba(30, 41, 59, 0.4)",
                                    border: "1px dashed rgba(255,255,255,0.2)",
                                    borderRadius: "12px",
                                    padding: "24px",
                                    textAlign: "center",
                                    color: "#6b7280"
                                }}>
                                    <div style={{ fontSize: "14px", marginBottom: "8px" }}>バブルをクリックまたはホバー</div>
                                    <div style={{ fontSize: "12px" }}>で詳細を表示</div>
                                </div>
                            )}
                        </div>
                    </div>

                    <div style={{ display: "flex", justifyContent: "center", gap: "20px", marginTop: "12px", fontSize: "12px", flexWrap: "wrap" }}>
                        <div style={{ display: "flex", alignItems: "center", gap: "16px" }}>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px" }}>
                                <span style={{ width: "14px", height: "14px", background: "#22c55e", borderRadius: "50%", opacity: 0.9 }}></span>
                                最優先: {counts.prime}
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px" }}>
                                <span style={{ width: "14px", height: "14px", background: "#3b82f6", borderRadius: "50%", opacity: 0.9 }}></span>
                                安定: {counts.stable}
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px" }}>
                                <span style={{ width: "14px", height: "14px", background: "#f97316", borderRadius: "50%", opacity: 0.9 }}></span>
                                投機的: {counts.spec}
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px" }}>
                                <span style={{ width: "14px", height: "14px", background: "#ef4444", borderRadius: "50%", opacity: 0.9 }}></span>
                                慎重: {counts.avoid}
                            </span>
                        </div>
                        <span style={{ color: "#4b5563" }}>|</span>
                        <div style={{ display: "flex", alignItems: "center", gap: "12px" }}>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px", color: "#9ca3af" }}>
                                <span style={{ width: "16px", height: "16px", border: "2.5px dashed #ef4444", borderRadius: "50%" }}></span>
                                高構造的優位性 (≥16)
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px", color: "#9ca3af" }}>
                                <span style={{ width: "16px", height: "16px", background: "rgba(234, 179, 8, 0.4)", borderRadius: "50%", border: "3px solid #fbbf24" }}></span>
                                #1
                            </span>
                            <span style={{ display: "flex", alignItems: "center", gap: "4px", color: "#6b7280" }}>
                                <span style={{ width: "14px", height: "14px", background: "#6b7280", borderRadius: "50%", opacity: 0.5 }}></span>
                                16位以下
                            </span>
                        </div>
                    </div>
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<QuadrantChart />);
    </script>
</body>
</html>
